"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[3878],{65123:(e,a,t)=>{t.r(a),t.d(a,{default:()=>ha});var i=t(67294),n=t(86706),l=t(51615),r=t(69518),s=t.n(r),o=t(28760),c=t(87577),d=t(95222),m=t(96206),u=t(42038),k=t(83056);const p=(e,a,t)=>({event:e,app_startup_id:null,ad_playback_id:null,ad_id:String(a),lineitem_id:String(t),creative_id:String(a),ad_format:"sponsored playlist",slot:null,in_focus:null,username:null,jsondata:JSON.stringify({platform:"WebPlayer",revision:"1.0.0"})}),v=({clickTracking:e,clickThrough:a,thirdPartyImpression:t,impression:l,logoUrl:r,advertiserName:s,creativeId:c,lineItemId:d})=>{const u=(0,n.I0)(),[v,S]=(0,i.useState)(!1);return(0,i.useEffect)((()=>(u((0,k.Vw)()),u((0,k.kh)(p("event_viewed",c,d))),()=>{u((0,k.AG)())})),[u,c,d]),i.createElement("div",{className:"sponsor-container"},i.createElement(o.Dy,{variant:"minuet",className:"sponsor-text","data-ta-id":"sponsor-text"},m.ag.get("playlist.presented_by",s)),i.createElement("div",{className:"sponsor-logo"},i.createElement("a",{draggable:!1,className:"sponsor-logo__link",target:"_blank",href:a,onClick:()=>{u((0,k.kh)(p("event_clicked",c,d))),S(!0)}},i.createElement("img",{draggable:!1,className:"sponsor-logo__image",src:r,alt:s,"data-ta-id":"sponsor-logo"})),i.createElement("img",{className:"sponsor-logo__imp-pixel",src:l,alt:""}),t&&i.createElement("img",{className:"sponsor-logo__3p-imp-pixel",src:t,alt:""}),v&&i.createElement("img",{className:"sponsor-logo__click-img-pixel",src:e,alt:""})))},S=({playlistUri:e})=>{const a=(0,n.I0)(),t=(0,n.v9)((a=>a.ads.sponsoredPlaylist.previewAd||a.ads.sponsoredPlaylist.sponsoredPlaylist.get(e)));return(0,i.useEffect)((()=>{t||a((0,k.fd)(e))}),[a,e,t]),t?i.createElement("div",null,i.createElement(v,t)):null},y=({playlistUri:e})=>{const a=(0,n.I0)(),t=(0,n.v9)((e=>e.ads.sponsoredPlaylist.sponsoredPlaylist.get("allSponsorships"))),l=(0,n.v9)((e=>e.ads.sponsoredPlaylist.previewAd));(0,i.useEffect)((()=>{t||a((0,k.z8)())}),[a,t]);const r=l||t&&((e,a)=>{const t=Date.now()/1e3,i=e.split(":"),n=i[i.length-1];return a.some((({playlistId:e,endTime:a,startTime:i})=>e===n&&t>=i&&t<(a||t+1)))})(e,t);return r?i.createElement(S,{playlistUri:e}):null};var g=t(90110),N=t(95661),b=t(35410),E=t(20534),f=t(70369),h=t(19565),F=t(98778),T=t(66668),R=t(99450),C=t(4383);const I="hOOwEKqNuXrNvOCB1SgZ",A="csEdkIN9z2LjJIuZraqz",L=({uri:e})=>{const[a,t]=(0,C.Z)(e),n=(0,l.k6)(),r=(0,i.useCallback)((()=>{t(!1),n.replace("/collection/playlists")}),[n,t]);return i.createElement("div",{className:I},i.createElement(T.l,{iconSize:64}),i.createElement("div",{className:A},i.createElement(o.Dy,{as:"p",variant:"canon"},m.ag.get("forbidden-page.title")),i.createElement(o.Dy,{as:"p",variant:"mesto"},m.ag.get("forbidden-page.description"))),a&&i.createElement(R.D,{colorSet:"invertedLight",onClick:r},m.ag.get("remove_from_your_library")))};var D=t(84200),U=t(1663),w=t(55120),x=t(2751),P=t(1838),M=t(22423),B=t(78462),_=t(61412),O=t(12498),V=t(69846),Z=t(99191),Q=t(1169),z=t(56802),K=t(4236),G=t(53538),q=t(49207),W=t(29255),X=t(30947),j=t(11414),H=t(55911),J=t(20246),$=t(18061),Y=t(32648),ee=t(43620),ae=t(50062),te=t(84242),ie=t(72138),ne=t(73893),le=t(97194),re=t(54444),se=t(28248),oe=t(42922),ce=t(28018),de=t(49961);const me=new Set(B.RJ),ue=new Set([]),ke={column:null,order:se.kn.NONE},pe=i.memo((function({ariaLabel:e,nrTracks:a,playlistUri:t,rankType:n,scrollToUid:l,usePlayContextItem:r,tracklistDomRef:s}){const o=(0,i.useContext)(ie.ZF),{filter:c,setFilter:d}=(0,i.useContext)(M.fo),m=(0,i.useRef)(null),[u,k]=(0,i.useState)(a),p=(0,i.useCallback)((()=>{m.current&&m.current.update()}),[]);(0,ce.r)(t,p);const{sortState:v,setSortState:S}=(0,i.useContext)(B.Gb),y=(0,i.useCallback)((e=>{S((0,P.VK)(e,v))}),[v,S]);(0,i.useEffect)((()=>{m.current&&m.current.update()}),[v,c]),(0,i.useEffect)((()=>{S(ke),d("")}),[t,d,S]),(0,i.useEffect)((()=>{m.current&&l&&m.current.scrollToItem({uid:l})}),[l]),(0,i.useEffect)((()=>{m.current&&""===c&&m.current.scrollToFirstSelected()}),[c,u]);const g=(0,i.useCallback)((async(e,a)=>{const i=await o.getContents(t,{offset:e,limit:a,sort:(0,P._j)(v),filter:c,decorateFormatListData:!0});return i.totalLength!==u&&k(i.totalLength),i.items}),[t,o,u,v,c]),N="plays"===n,b=(0,i.useCallback)(((e,a)=>{const n=(0,de.X)(e.album?.images,{desiredSize:40,desiredLabel:"small"});return i.createElement(se.h_,{key:a+e.uri,index:a,contextUri:t,uri:e.uri,uid:e.uid||void 0,isPlayable:e.isPlayable,duration_ms:e.duration.milliseconds,name:e.name,artists:e.artists,album:e.album,isExplicit:e.isExplicit,isMOGEFRestricted:e.is19PlusOnly,type:e.type,imgUrl:n?.url||"",statusChange:e.formatListAttributes?.status,showPlayCount:N,playCount:parseInt(e.formatListAttributes?.rank||"0",10),usePlayContextItem:r})}),[t,N,r]),E=(0,i.useMemo)((()=>N?[se.QD.INDEX,se.QD.TITLE,se.QD.PLAYS,se.QD.ALBUM,se.QD.DURATION]:[se.QD.INDEX,se.QD.TITLE,se.QD.ALBUM,se.QD.DURATION]),[N]),f=(0,i.useCallback)((e=>e.uri),[]),h=(0,i.useCallback)((e=>e.id),[]);return i.createElement(oe.ZP,{value:"chart-tracklist"},i.createElement(se.Pv,{key:t,ariaLabel:e,hasHeaderRow:!0,columns:E,sortableColumns:o.getCapabilities().canSort?me:ue,sortState:v,onSort:y,renderRow:b,resolveUri:f,resolveUid:h,nrTracks:u,fetchTracks:g,limit:100,canFetchAllTracks:o.getCapabilities().canFetchAllTracks,outerRef:m,outerDomRef:s}))}));var ve=t(87462),Se=t(77082),ye=t(83692),ge=t(51627);const Ne="X1lXSiVj0pzhQCUo_72A",be=({uri:e,label:a,onClick:t,...n})=>{const{onCopyLink:l}=(0,ge.l)({uri:e,permissionLevel:"CONTRIBUTOR"});return i.createElement(ye.w,{label:a},i.createElement(Se.t,(0,ve.Z)({},n,{className:Ne,onClick:e=>{t?.(e),l?.()},iconSize:32})))};var Ee=t(40786),fe=t(94184),he=t.n(fe),Fe=t(10149),Te=t(728),Re=t(61633),Ce=t(3775);t(98984);const Ie={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"querySearch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"term"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"search"},arguments:[{kind:"Argument",name:{kind:"Name",value:"query"},value:{kind:"Variable",name:{kind:"Name",value:"term"}}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"5"}},{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"numberOfTopResults"},value:{kind:"IntValue",value:"10"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"query"}},{kind:"Field",name:{kind:"Name",value:"tracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uid"}},{kind:"Field",name:{kind:"Name",value:"track"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"artists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"album"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"artists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}},{kind:"Field",name:{kind:"Name",value:"visuals"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarImage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"albums"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"episodes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uid"}},{kind:"Field",name:{kind:"Name",value:"episode"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"podcast"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"topResults"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Artist"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Episode"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Album"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Track"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}}]}}]}}]}}]}}]},Ae={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"querySearchAlbum"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"album"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"tracks"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uid"}},{kind:"Field",name:{kind:"Name",value:"track"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"artists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}}]}}]}}]}}]}}]}}]},Le={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"querySearchArtist"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"artist"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"following"}},{kind:"Field",name:{kind:"Name",value:"sharingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}}]}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}},{kind:"Field",name:{kind:"Name",value:"visuals"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarImage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"discography"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"popularReleases"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"releases"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"1"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"topTracks"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uid"}},{kind:"Field",name:{kind:"Name",value:"track"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"artists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"album"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}}]}}]}}]}}]}}]}}]}}]};var De=t(7438),Ue=t(64005);const we={filterInputContainer:"WIBrW3xa1aqQaLWZhp5U",filterInput:"l42JW4EP_5CU1Ba7jYIc",overlay:"yGtsjz2AjzhRMTphe2BO",searchIconContainer:"TuU4JSqLFdjOeTaHaDmA",searchIcon:"zOwN1vkkgX9JIvE81_B2",clearButton:"eWEdt6BMCWITt5najIg_"},xe=i.memo((function({placeholder:e,onChange:a=(()=>{}),onFocus:t=(()=>{})}){const[n,l]=(0,i.useState)(""),r=(0,i.useRef)(null),s=(0,Ue.y)((e=>{a(e)}),200),c=(0,i.useCallback)((e=>{const a=e.currentTarget.value;l(a),s(a)}),[l,s]),d=(0,i.useCallback)((()=>{r.current&&r.current.focus(),l(""),a("")}),[l,a]),u=(0,i.useCallback)((e=>{"Escape"===e.key&&n&&d()}),[n,d]);return i.createElement("div",{className:we.filterInputContainer,role:"search"},i.createElement(o.Dy,{as:"input",variant:"mesto",ref:r,className:he()(we.filterInput),role:"searchbox",maxLength:80,autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,placeholder:e,onChange:c,onKeyDown:u,onFocus:t,value:n}),i.createElement("div",{className:we.overlay},i.createElement("span",{className:we.searchIconContainer},i.createElement(De.j,{iconSize:16,className:we.searchIcon,"aria-hidden":"true"})),n&&i.createElement("button",{className:we.clearButton,onClick:d,"aria-label":m.ag.get("search.a11y.clear-input")},i.createElement(Fe.k,{iconSize:16,className:we.filterInputIcon}))))}));var Pe=t(7073),Me=t(42781);const Be=e=>({uid:e.uid,uri:e.track.uri,name:e.track.name,isPlayable:e.track.playability.playable,isMOGEFRestricted:e.track.contentRating.label===Pe.KS.NineteenPlus,isExplicit:e.track.contentRating.label===Pe.KS.Explicit,album:{id:e.track.album.id,name:e.track.album.name,imgUrl:e.track.album.coverArt?.sources[0].url||"",uri:e.track.album.uri},artists:e.track.artists.items.map((e=>({id:e.id,uri:e.uri,name:e.profile.name})))}),_e=e=>({uid:e.uid,uri:e.episode.uri,name:e.episode.name,isPlayable:e.episode.playability.playable,isMOGEFRestricted:e.episode.contentRating.label===Pe.KS.NineteenPlus,isExplicit:e.episode.contentRating.label===Pe.KS.Explicit,imgUrl:e.episode.coverArt.sources[0].url,podcast:{id:e.episode.podcast.id,uri:e.episode.podcast.uri,name:e.episode.podcast.name}}),Oe=({renderRow:e,searchResults:a})=>i.createElement(se.Pv,{ariaLabel:m.ag.get("search.title.top-results"),renderRow:e,rowPlaceholder:se.hU,nrTracks:a.length,tracks:a,resolveUri:e=>e.uri,columns:[se.QD.TITLE,se.QD.ALBUM,se.QD.ADD],testID:"playlist-inline-curation-loaded-results"}),Ve=({renderRow:e,searchResults:a})=>i.createElement(se.Pv,{ariaLabel:m.ag.get("search.title.top-results"),renderRow:e,rowPlaceholder:se.hU,nrTracks:a.length,tracks:a,resolveUri:e=>e.uri,columns:[se.QD.TITLE,se.QD.ALBUM,se.QD.ADD]}),Ze=({renderRow:e,searchResults:a})=>{const t=a.filter((e=>void 0!==e.album)),n=a.filter((e=>e.uri.includes("album")));return i.createElement("div",null,i.createElement(o.Dy,{as:"p",variant:"cello",className:x.Z.artistResultListTitle},m.ag.get("playlist.curation.popular_songs")),i.createElement(se.Pv,{ariaLabel:m.ag.get("playlist.curation.popular_songs"),renderRow:e,rowPlaceholder:se.hU,nrTracks:t.length,tracks:t,resolveUri:e=>e.uri,columns:[se.QD.TITLE,se.QD.ALBUM,se.QD.ADD]}),i.createElement(o.Dy,{as:"p",variant:"cello",className:x.Z.artistResultListTitle},m.ag.get("playlist.curation.albums")),i.createElement(se.Pv,{ariaLabel:m.ag.get("playlist.curation.albums"),renderRow:e,rowPlaceholder:se.hU,nrTracks:n.length,tracks:n,resolveUri:e=>e.uri,columns:[se.QD.TITLE,se.QD.ALBUM,se.QD.ADD]}))},Qe=({renderRow:e,searchResults:a})=>i.createElement(se.Pv,{ariaLabel:m.ag.get("search.title.top-results"),renderRow:e,rowPlaceholder:se.hU,nrTracks:a.length,tracks:a,resolveUri:e=>e.uri,columns:[se.QD.TITLE,se.QD.ALBUM,se.QD.ADD]}),ze=({renderRow:e,searchResults:a})=>i.createElement(se.Pv,{ariaLabel:m.ag.get("search.title.top-results"),renderRow:e,rowPlaceholder:se.hU,nrTracks:a.length,tracks:a,resolveUri:e=>e.uri,columns:[se.QD.TITLE,se.QD.ALBUM,se.QD.ADD]}),Ke=({renderRow:e,searchResults:a})=>i.createElement(se.Pv,{ariaLabel:m.ag.get("search.title.top-results"),renderRow:e,rowPlaceholder:se.hU,nrTracks:a.length,tracks:a,resolveUri:e=>e.uri,columns:[se.QD.TITLE,se.QD.ALBUM,se.QD.ADD]});var Ge=t(7739);const qe={artistIcon:"Gt26Myd3dsGrVxW9ArZW",artistImagePlaceholder:"MLeLx_C7OnluWx8e9S88",podcastIcon:"T6tkS1BFfNkJ4BNUf9Br",albumIcon:"p8hNoO_LkxYLrEJ2cCSF",searchResultTitle:"FETh66aSunr0whiLsmk4",searchResultContainer:"KAuXIg8XQPSRMRqTjvAD",rowContent:"NB2fhkFoxu_ZCQlzHhha",searchResultTitleContainer:"saXvuHxalPYz3i36v1Ve",seeMoreButton:"DhMJGiOreiPrq04sm2AF",seeMoreRowButton:"gkgL9fB_pyDL75m9HKdu"},We=({searchResult:e,index:a,isRTL:t,onClick:n})=>{const l=e.coverArt?.sources[0].url;return i.createElement(Ge.RX,{className:qe.searchResultContainer,rowIndex:a,"aria-selected":!1},i.createElement("div",{"aria-label":`${m.ag.get("artist-page.tracks.seemore")} ${e.name}`,className:qe.seeMoreRowButton,onClick:n},i.createElement(Ge.id,{columnIndex:0,className:qe.rowContent},void 0!==l?i.createElement("img",{className:qe.albumIcon,src:e.coverArt.sources[0].url,alt:e.name}):null,i.createElement("div",{className:qe.searchResultTitleContainer},i.createElement(o.Dy,{as:"p",className:qe.searchResultTitle,variant:"ballad"},e.name),i.createElement(o.Dy,{as:"p",variant:"mesto",semanticColor:"textSubdued"},m.ag.get("album")))),i.createElement(Ge.id,{columnIndex:1}),i.createElement(Ge.id,{columnIndex:2},i.createElement("button",{"data-testid":"top-bar-forward-button","aria-label":`See more from ${e.name}`,className:qe.seeMoreButton,onClick:n},t?i.createElement(Re.e,{className:qe.icon}):i.createElement(Te.V,{className:qe.icon})))))};var Xe=t(5843);const je=({size:e})=>i.createElement("div",{className:qe.artistImagePlaceholder},i.createElement(Xe.a,{iconSize:e})),He=({searchResult:e,index:a,isRTL:t,onClick:n})=>{const l=e.visuals.avatarImage?.sources[0].url;return i.createElement(Ge.RX,{className:qe.searchResultContainer,rowIndex:a,"aria-selected":!1},i.createElement("div",{"aria-label":`${m.ag.get("artist-page.tracks.seemore")} ${e.profile.name}`,className:qe.seeMoreRowButton,onClick:n,"data-testid":"playlist-inline-curation-artist"},i.createElement(Ge.id,{columnIndex:0,className:qe.rowContent},void 0!==l?i.createElement("img",{className:qe.artistIcon,src:l,alt:e.profile.name}):i.createElement(je,{size:16}),i.createElement("div",{className:qe.searchResultTitleContainer},i.createElement(o.Dy,{as:"p",className:qe.searchResultTitle,variant:"ballad"},e.profile.name),i.createElement(o.Dy,{as:"p",variant:"mesto",semanticColor:"textSubdued"},m.ag.get("artist")))),i.createElement(Ge.id,{columnIndex:1}),i.createElement(Ge.id,{columnIndex:2},i.createElement("button",{"data-testid":"top-bar-forward-button","aria-label":`See more from ${e.profile.name}`,className:qe.seeMoreButton,onClick:n},t?i.createElement(Re.e,{className:qe.icon}):i.createElement(Te.V,{className:qe.icon})))))},Je=({episode:{uid:e,uri:a,name:t,imgUrl:n,podcast:l,isPlayable:r,isMOGEFRestricted:s,isExplicit:o},contextUri:c,index:d,usePlayContextItem:m})=>i.createElement(se.YK,{uid:e,uri:a,isPlayable:r,isMOGEFRestricted:s,isExplicit:o,contextUri:c,name:t,imgUrl:n,index:d,podcast:l,usePlayContextItem:m}),$e=({label:e,index:a,isRTL:t,onClick:n})=>i.createElement(Ge.RX,{className:qe.searchResultContainer,rowIndex:a,"aria-selected":!1},i.createElement("div",{"aria-label":e,className:qe.seeMoreRowButton,onClick:n},i.createElement(Ge.id,{columnIndex:0,className:qe.rowContent},i.createElement(o.Dy,{as:"p",className:qe.searchResultTitle,variant:"ballad"},e)),i.createElement(Ge.id,{columnIndex:1}),i.createElement(Ge.id,{columnIndex:2},i.createElement("button",{"data-testid":"top-bar-forward-button","aria-label":e,className:qe.seeMoreButton,onClick:n},t?i.createElement(Re.e,{className:qe.icon}):i.createElement(Te.V,{className:qe.icon}))))),Ye=({track:{uid:e,uri:a,album:t,name:n,artists:l,isPlayable:r,isExplicit:s,isMOGEFRestricted:o},contextUri:c,index:d,usePlayContextItem:m})=>i.createElement(se.cp,{uid:e,uri:a,isPlayable:r,isMOGEFRestricted:o,isExplicit:s,contextUri:c,name:n,imgUrl:t.imgUrl,index:d,album:t,artists:l,usePlayContextItem:m});let ea;!function(e){e[e.SEARCH=0]="SEARCH",e[e.ALBUM=1]="ALBUM",e[e.ARTIST=2]="ARTIST",e[e.PODCAST=3]="PODCAST",e[e.PLAYLIST=4]="PLAYLIST",e[e.ALBUMRESULTS=5]="ALBUMRESULTS",e[e.ARTISTRESULTS=6]="ARTISTRESULTS",e[e.PODCASTRESULTS=7]="PODCASTRESULTS",e[e.EPISODERESULTS=8]="EPISODERESULTS",e[e.TRACKRESULTS=9]="TRACKRESULTS"}(ea||(ea={}));const aa=(e,a)=>"GO_BACK"===a.type?1===e.breadcrumbs.length?e:e={...e,breadcrumbs:e.breadcrumbs.slice(0,e.breadcrumbs.length-1)}:"NAV_TO_ENTITY"===a.type?e={...e,breadcrumbs:[...e.breadcrumbs,a.level]}:("NAV_TO_RESULTS"===a.type?e={...e,breadcrumbs:[...e.breadcrumbs,a.level]}:"CHANGE_TERM"===a.type&&(e={term:a.term,breadcrumbs:[{navType:ea.SEARCH,term:a.term,title:""}]}),e),ta=({resultList:e,level:a,isRTL:t,playlistUri:n,navToResults:l,navToEntity:r,term:c})=>{let d=e;const u=(e=>e.filter((({uri:e})=>s().isTrack(e)||s().isEpisode(e))).map((({uri:e,uid:a})=>({type:s().isTrack(e)?Me.p.TRACK:Me.p.EPISODE,uri:e,uid:a,provider:null}))))(e),{usePlayContextItem:k}=(0,te.n)({uri:`${n.replace("spotify:","spotify:internal:recs:")}:${encodeURIComponent(c)}:${a?.navType??0}`,pages:[{items:u}]},{featureIdentifier:"search"}),p=(0,i.useCallback)(((e,a)=>e?void 0!==e.profile?i.createElement(He,{isRTL:t,index:a,key:e.uri,searchResult:e,onClick:()=>{r({navType:ea.ARTIST,uri:e.uri,title:e.profile.name})}}):void 0!==e.podcast?i.createElement(Je,{key:e.uri,index:a,episode:e,contextUri:n.replace("spotify:","spotify:internal:recs:"),usePlayContextItem:k}):void 0!==e.album?i.createElement(Ye,{key:e.uri,index:a,track:e,contextUri:n.replace("spotify:","spotify:internal:recs:"),usePlayContextItem:k}):e.isSeeAllXRow?i.createElement($e,{isRTL:t,index:a,label:e.label,key:e.uri,onClick:()=>{l({navType:e.type,term:c,title:e.label})}}):e.uri.includes("album")?i.createElement(We,{index:a,key:e.uri,isRTL:t,searchResult:e,onClick:()=>{r({navType:ea.ALBUM,uri:e.uri,title:e.name})}}):null:null),[t,r,l,n,c,k]);if(""===c)return i.createElement("div",{className:x.Z.emptySearchTermContainer});if(!e||0===e?.length)return i.createElement("div",{className:x.Z.emptyStateContainer},i.createElement(o.Dy,{as:"h1",variant:"canon"},m.ag.get("search.empty-results-title",c)),i.createElement(o.Dy,{as:"p",variant:"mesto"},m.ag.get("search.empty-results-text")));if(a?.navType===ea.SEARCH){const a=[{type:ea.ARTISTRESULTS,label:m.ag.get("playlist.curation.see_all_artists"),isSeeAllXRow:!0,uri:"spotify:internal:recs:see-all-artists"},{type:ea.ALBUMRESULTS,label:m.ag.get("playlist.curation.see_all_album"),isSeeAllXRow:!0,uri:"spotify:internal:recs:see-all-albums"},{type:ea.TRACKRESULTS,label:m.ag.get("playlist.curation.see_all_songs"),isSeeAllXRow:!0,uri:"spotify:internal:recs:see-all-songs"}];return d=[...e,...a],i.createElement(Oe,{renderRow:p,searchResults:d})}return a?.navType===ea.ALBUM?i.createElement(Ve,{renderRow:p,searchResults:d}):a?.navType===ea.ARTIST?i.createElement(Ze,{renderRow:p,searchResults:d}):a?.navType===ea.ALBUMRESULTS?i.createElement(Qe,{renderRow:p,searchResults:d}):a?.navType===ea.TRACKRESULTS?i.createElement(ze,{renderRow:p,searchResults:d}):a?.navType===ea.ARTISTRESULTS?i.createElement(Ke,{renderRow:p,searchResults:d}):null},ia=({playlistUri:e,onCurationModeChange:a})=>{const[t,l]=(0,i.useState)([]),[r,c]=(0,i.useState)(),d=(0,n.v9)((e=>e.ui.textDirection.isRTL)),{level:u,changeTerm:k,goBack:p,navToEntity:v,navToResults:S,term:y}=(()=>{const[e,a]=(0,i.useReducer)(aa,{term:"",breadcrumbs:[]}),{breadcrumbs:t,term:n}=e;return{changeTerm:e=>{a({type:"CHANGE_TERM",term:e})},level:t[t.length-1]||null,goBack:()=>{a({type:"GO_BACK"})},navToEntity:e=>{a({type:"NAV_TO_ENTITY",level:e})},navToResults:e=>{a({type:"NAV_TO_RESULTS",level:e})},term:n}})(),{request:g}=(0,i.useContext)(Ce.Ax),N=(0,i.useCallback)((async e=>(await g(Ie,{term:e}))?.data.search||null),[g]),b=(0,i.useCallback)((async e=>(await g(Ae,{uri:e,offset:0,limit:100}))?.data.album||null),[g]),E=(0,i.useCallback)((async e=>(await g(Le,{uri:e,offset:0,limit:100}))?.data.artist||null),[g]);return(0,i.useEffect)((()=>{let e=!0;return(async()=>{var a;if(u)switch(u.navType){case ea.SEARCH:try{if(!r||r.query!==y&&""!==y){const a=await N(y);e&&c(a)}else""===y&&l([])}catch{l([])}if(r){const e=(e=>{const a=e?.topResults?.items??[];return a.length?a.reduce(((a,t)=>{const i=t.uri,n=s().from(i);if(i&&n)switch(s().from(i)&&s().from(i).type){case s().Type.ALBUM:{const t=((e,a)=>a.find((a=>a.uri===e)))(i,e?.albums?.items||[]);t&&a.push(t);break}case s().Type.ARTIST:{const t=((e,a)=>a.find((a=>a.uri===e)))(i,e?.artists?.items||[]);t&&a.push(t);break}case s().Type.TRACK:{const t=((e,a)=>a.find((a=>a.track.uri===e)))(i,e?.tracks?.items||[]);t&&a.push(Be(t));break}case s().Type.EPISODE:{const t=((e,a)=>a.find((a=>a.episode.uri===e)))(i,e?.episodes?.items||[]);t&&a.push(_e(t));break}}return a}),[]):[]})(r);l(e)}break;case ea.ARTISTRESULTS:l(r?.artists?.items);break;case ea.ALBUMRESULTS:l(r?.albums?.items);break;case ea.TRACKRESULTS:{const e=r?.tracks?.items;e?.length&&l(e.map((e=>Be(e))));break}case ea.EPISODERESULTS:{const e=r?.episodes?.items;e?.length&&l(e.map((e=>_e(e))));break}case ea.ALBUM:try{const a=await b(u.uri);e&&l((e=>{const a={uri:e.uri,id:e.id,name:e.name,coverArt:e.coverArt};return e.tracks.items.map((e=>({...e,track:{...e.track,album:a}})))})(a).map((e=>Be(e))))}catch{l([])}break;case ea.ARTIST:try{const t=await E(u.uri);e&&l((a=t).discography?[...a.discography.topTracks.items.map((e=>Be(e))),...a.discography.popularReleases.items.map((e=>{const{uri:a,name:t,coverArt:{sources:i}}=e.releases.items[0];return{uri:a,name:t,coverArt:{sources:i}}}))]:[])}catch{l([])}}})(),()=>{e=!1}}),[u,N,b,E,y,r]),i.createElement(i.Fragment,null,i.createElement("section",{className:x.Z.playlistInlineCurationSection},i.createElement("div",{className:x.Z.playlistInlineCurationWrapper},i.createElement(o.Dy,{as:"h1",className:x.Z.playlistInlineCurationTitle,variant:"canon"},m.ag.get("playlist.curation.title")),i.createElement(i.Suspense,{fallback:null},i.createElement(xe,{placeholder:m.ag.get("playlist.curation.search_placeholder"),onFocus:()=>{a(!0)},onChange:e=>{k(e)}}))),i.createElement("button",{className:x.Z.playlistInlineCurationCloseButton,onClick:()=>a(!1)},i.createElement(Fe.k,{className:x.Z.closeIcon,"aria-label":m.ag.get("close")}))),null!==u&&u.navType!==ea.SEARCH?i.createElement("button",{className:x.Z.playlistInlineCurationBackButton,onClick:()=>p()},d?i.createElement(Te.V,{"aria-label":m.ag.get("navbar.go-back"),className:he()([x.Z.icon,x.Z.iconRight])}):i.createElement(Re.e,{"aria-label":m.ag.get("navbar.go-back"),className:he()([x.Z.icon,x.Z.iconLeft])}),i.createElement(o.Dy,{as:"p",variant:"cello"},u.title)):null,i.createElement("div",{className:x.Z.searchResultListContainer,"data-testid":"playlist-inline-curation-results"},i.createElement(ta,{playlistUri:e,term:y,level:u,resultList:t,navToEntity:v,navToResults:S,isRTL:d})))};var na=t(98816),la=t(61048),ra=t(35213);const sa=i.memo((({metadata:e})=>{const{hasEpisodes:a,isCollaborative:t,formatListData:n,hasDateAdded:l,collaborators:r}=e,s="chart"===n?.type,o="live-streams"===n?.type,c=["blend","celebrity-blend","friends-mix"].indexOf(n?.type||"")>-1,d=!!a,{spec:u,logger:k}=(0,re.fU)(na.createDesktopSearchBarEventFactory,{}),p=(0,i.useCallback)((()=>{k.logInteraction(u.filterFieldFactory().keyStrokeFilter())}),[k,u]),v=(0,i.useCallback)((()=>{k.logInteraction(u.filterFieldFactory().hitClearFilter())}),[k,u]),S=(0,i.useCallback)((()=>{k.logInteraction(u.sortButtonFactory().hitSort())}),[k,u]),{filterBoxApiRef:y,filterBoxDomRef:g}=(0,Q.Q)(),N=(0,i.useMemo)((()=>((e,a,t,i,n,l,r)=>e?B.RJ:(0,P.RG)(a,t,i,n,l,r))(s,t,d,l,o,c,r?.count??1)),[s,t,d,l,o,c,r]);return i.createElement("div",{className:x.Z.searchBoxContainer},i.createElement(i.Suspense,{fallback:null},i.createElement(la.K,{placeholder:m.ag.get("playlist.search_in_playlist"),filterBoxApiRef:y,outerRef:g,onFilter:p,onClear:v})),i.createElement(ra.l,{columns:N,onSort:S}))}));var oa=t(35308),ca=t(82760);const da="multiUserAttributionDisplayNamesV2";var ma=t(59916);function ua(e){return(0,ma.MW)(e)||(0,ma.JF)(e)}const ka=new Set(B.zq),pa=new Set([]),va=i.memo((function({ariaLabel:e,nrTracks:a,playlistUri:t,playlistName:l,isCollaborative:r,isMixedMedia:o,isLive:c,isBlend:d,hasDateAdded:k,canEdit:p,scrollToUid:v,feedbackPath:S,deleteFeedbackPath:y,usePlayContextItem:g,tracklistRef:N,tracklistDomRef:b,nrCollaborators:E=1,canRemove:f,spec:h}){const F=(0,re.$P)(),T=(0,i.useContext)(ie.ZF),{filter:R}=(0,i.useContext)(M.fo),{sortState:C,setSortState:I}=(0,i.useContext)(B.Gb),[A,L]=(0,i.useState)(a),D=(0,i.useRef)((()=>{})),[U,w]=(0,i.useState)([]),x=(0,i.useRef)({}),_=(0,n.I0)(),O=(0,i.useCallback)((()=>{N?.current&&N.current.update()}),[N]);(0,ce.r)(t,O);const V=(0,i.useCallback)(((e,a)=>{I((0,P.VK)(e,C)),F.logInteraction(h.columnHeaderFactory({identifier:e,position:a||0}).hitSort())}),[I,C,F,h]),Q=(0,i.useCallback)((e=>{D.current(),T.remove(t,e)}),[T,t]),z=(0,i.useCallback)(((e,a,t=!1)=>{f&&(D.current=a,e.length>1&&!t?w(e):Q(e))}),[f,Q]);(0,i.useEffect)((()=>{N?.current&&N.current.update()}),[C,R,N]),(0,i.useEffect)((()=>{N?.current&&v&&N.current.scrollToItem({uid:v})}),[v,N]),(0,i.useEffect)((()=>{N?.current&&""===R&&N.current.scrollToFirstSelected()}),[R,A,N]);const K=(0,i.useCallback)((async(e,a)=>{const i=await T.getContents(t,{offset:e,limit:a,sort:(0,P._j)(C),filter:R,decorateFormatListData:!!S||c||d}),n=i.items.filter(((a,t)=>null!==a||(x.current[t+e]=!0,!1))),l=Object.keys(x.current).length;return i.totalLength-l!==A&&L(i.totalLength-l),n}),[t,T,A,C,R,S,c,d]),G=(0,i.useCallback)(((e,a,i)=>{if(!N?.current)return;const n=N.current.getRows();n[a].id&&(F.logInteraction(h.dragSort()),i===ca.W.Before?T.move(t,e,{before:n[a].id}):T.move(t,e,{after:n[a].id}))}),[N,F,h,T,t]),q=(0,i.useCallback)(((e,a,i)=>{if(!N?.current)return;const n=N.current.getRows();n[a].id&&(F.logInteraction(h.dragAddToPlaylist({playlist:t,itemToBeAdded:e[0]})),i===ca.W.Before?_((0,u.jV)(t,e,{before:n[a].id})):_((0,u.jV)(t,e,{after:n[a].id})))}),[N,F,h,t,_]),W=(0,i.useCallback)((()=>{T.resync(t)}),[T,t]),X=(0,i.useCallback)(((e,a)=>{let n,l;const m=!!(0,ma.JF)(e)&&e.podcastSubscription.isUserSubscribed;(0,ma.JF)(e)?(n=e.show,l=e.images.concat(e.show.images)):(0,ma.MW)(e)&&(n=e.album,l=e.album?.images);const u=(0,de.X)(l,{desiredSize:40,desiredLabel:"small"});let k=[];p&&C.order===se.kn.NONE&&(k=[Z.aN[s().Type.TRACK],Z.aN[s().Type.LOCAL],Z.aN[s().Type.EPISODE]]);const v="1"===e?.formatListAttributes?.["dislike-feedback-selected"];let N=!1;(0,ma.JF)(e)&&e.podcastSubscription.isPaywalled&&!m?N=!0:ua(e)&&(N=e.isPlayable&&!v);const b=d&&((e,a)=>{const t=[];if(!a)return t;const i=a?.[a[da]?da:"multiUserAttributionDisplayNames"]?.split(","),n=a?.multiUserAttributionImages?.split(",");if(!i||!n)return t;const l=a?.multiUserAttributionUsernamesV2?.split(",")||[],r=a?.multiUserAttributionType?.split(",")||[],o=i.length;for(let e=0;e<o;e++){const a=l[e],o=a&&s().profileURI(a).toURI();t.push({username:a,uri:o,displayName:i[e],images:(c=n[e],c.length>1?[{url:c}]:[]),recsplanation:r[e]})}var c;return t.sort(((a,t)=>a.username?a.username===e?.username?-1:t.username===e?.username?1:0:0))})(e.addedBy,e?.formatListAttributes)||e.addedBy&&[e.addedBy]||[];return i.createElement(se.dx,{key:a+e.uri,index:a,playIndex:e.playIndex??void 0,contextUri:t,uri:e.uri,uid:e.uid??void 0,id:e.id,isPlayable:N,duration_ms:ua(e)?e.duration.milliseconds:0,isPaywalled:!!(0,ma.JF)(e)&&e.podcastSubscription.isPaywalled,isUserSubscribed:m,name:ua(e)?e.name:"",artists:(0,ma.MW)(e)?e.artists:void 0,albumOrShow:n,isExplicit:(0,ma.MW)(e)&&e.isExplicit,isCollaborative:r,nrCollaborators:E,isMixedMedia:o,isLocal:(0,ma.MW)(e)&&e.isLocal,addedBy:b,hasDecoratedAddedBy:T.getCapabilities().canDecorateAddedBy,dateAdded:e.addedAt,release_date:(0,ma.JF)(e)&&e.release.date||"",isMOGEFRestricted:(0,ma.MW)(e)&&e.is19PlusOnly,type:e.type,imgUrl:u?.url||"",onMove:G,onInsert:q,usePlayContextItem:g,allowedDropTypes:k,feedbackPath:S,feedbackUri:e?.formatListAttributes?.feedback_uri,deleteFeedbackPath:y,isDisliked:v,isLive:c,isBlend:d,ticketingSiteURL:e?.formatListAttributes?.ticketingSite,eventDate:e?.formatListAttributes?.eventDate,canRemove:f,onFeedbackClick:W})}),[p,f,C,t,r,E,o,T,G,q,g,S,y,c,d,W]);return i.createElement(i.Fragment,null,i.createElement(oe.ZP,{value:"playlist-tracklist"},i.createElement(se.Pv,{testID:"playlist-tracklist",key:t,ariaLabel:e,hasHeaderRow:!0,columns:(0,P.RG)(r,o,k,c,d,E),sortableColumns:T.getCapabilities().canSort?ka:pa,sortState:C,onSort:V,onRemove:z,renderRow:X,resolveUri:e=>e.uri,resolveUid:e=>e.id,nrTracks:A,fetchTracks:K,limit:100,canFetchAllTracks:T.getCapabilities().canFetchAllTracks,outerRef:N,outerDomRef:b})),i.createElement(oa.h,{title:m.ag.get("playlist.remove_from_playlist",l),isOpen:U.length>0,tracks:U,onClose:e=>{e.stopPropagation(),w([])},onRemove:Q}))}));var Sa=t(21770),ya=t(42714),ga=t(27826),Na=t(61634);const ba=i.memo((function({playlistUri:e,playlistLength:a}){const{tracks:t,refresh:n}=((e,a=10)=>{const t=2*a,n=3*a,l=(0,i.useRef)(0),[r,s]=(0,i.useState)(e),[o,c]=(0,i.useState)([]),m=(0,i.useRef)([]),u=(0,i.useContext)(ya.Z),{spec:k,logger:p}=(0,re.fU)(d.createDesktopPlaylistEventFactory,{data:{uri:e}}),v=i.useMemo((()=>k.recommendedFactory()),[k]);(0,i.useEffect)((()=>{const a=u.getEvents(),t=a=>{a.data.uri===e&&c((e=>e.filter((e=>a.data.items.every((a=>a.uri!==e.uri))))))};return a.addListener(Na.XL.OPERATION_COMPLETE,t),()=>{a.removeListener(Na.XL.OPERATION_COMPLETE,t)}}),[u,e]),(0,i.useEffect)((()=>(c([]),s(e),m.current=[],l.current=l.current+1,()=>{l.current=l.current+1})),[e]),(0,i.useEffect)((()=>{if(o.length<t){const e=Math.min(t,n-o.length),a=l.current;u.getRecommendedTracks(r,m.current,e).then((t=>{if(a!==l.current)return;const i=t.map((e=>e?.uri&&ga.o.from(e.uri).id)).filter((e=>null!==e));t.length<e&&m.current.length?m.current=[]:m.current=[...m.current,...i],c((e=>[...e,...t]))}))}}),[t,n,u,r,o.length]);const S=(0,i.useCallback)((()=>{if(k){const e=v.refreshButtonFactory().hitRefreshContent();p.logInteraction(e)}c((e=>e.slice(a)))}),[p,v,k,a]);return{tracks:o.slice(0,a),_bufferedTracks:o.slice(a),refresh:S}})(e),l=!a||0===a,{usePlayContextItem:r}=(0,te.n)({uri:e.replace("spotify:","spotify:internal:recs:"),pages:[{items:t.map((e=>({...e,provider:null,type:Me.p.TRACK,uid:null})))}]},{featureIdentifier:"playlist_recommendations"}),s=(0,i.useCallback)(((a,t)=>i.createElement(se.cp,{key:a.uri,index:t,imgUrl:a.album.imageUrl,contextUri:e.replace("spotify","spotify:internal:recs"),uri:a.uri,isPlayable:!a.isMOGEFRestricted,name:a.name,artists:a.artists,album:{...a.album,imgUrl:a.album.imageUrl},isExplicit:a.explicit,isMOGEFRestricted:a.isMOGEFRestricted,usePlayContextItem:r})),[e,r]),c=(0,i.useMemo)((()=>[se.QD.TITLE,se.QD.ALBUM,se.QD.ADD]),[]),u=(0,i.useCallback)((e=>e.uri),[]),k=(0,i.useCallback)((e=>e.id),[]),p=(0,i.useMemo)((()=>t.slice(0,Math.min(t.length,10))),[t]);return t.length>0?i.createElement("div",{className:x.Z.recommendedTrackList},i.createElement("div",{className:x.Z.top},i.createElement("div",{className:x.Z.header},i.createElement(o.Dy,{variant:"canon",className:x.Z.title},m.ag.get("playlist.extender.recommended.title")),i.createElement(o.Dy,{variant:"mesto",className:x.Z.subtitle},l?m.ag.get("playlist.extender.title.in.playlist"):m.ag.get("playlist.extender.songs.in.playlist")))),t.length?i.createElement(i.Fragment,null,i.createElement(se.Pv,{ariaLabel:m.ag.get("playlist.extender.recommended.header"),key:`${e}-recommended`,nrTracks:Math.min(t.length,10),rowPlaceholder:se.hU,tracks:p,renderRow:s,resolveUri:u,resolveUid:k,columns:c}),i.createElement(Sa.oM,{className:x.Z.refreshButton,onClick:n},m.ag.get("playlist.extender.refresh"))):null):null})),Ea=i.lazy((()=>Promise.all([t.e(1814),t.e(3186),t.e(7405)]).then(t.bind(t,23186)))),fa=i.memo((function({metadata:e,capabilities:a}){const{uri:t,name:r,images:k,totalLength:p,isOwnedBySelf:v,isCollaborative:S,hasEpisodes:T,hasSpotifyTracks:R,canAdd:I,canRemove:A,canPlay:L,formatListData:U,hasDateAdded:V,collaborators:ie}=e,{spec:le,logger:se,UBIFragment:oe}=(0,re.fU)(d.createDesktopPlaylistEventFactory,{data:{uri:t}}),ce=i.useMemo((()=>le.headerFactory()),[le]),de=i.useMemo((()=>le.tracklistFactory()),[le]),me="chart"===U?.type,ue="live-streams"===U?.type,ke=["blend","celebrity-blend","friends-mix"].indexOf(U?.type||"")>-1,ve=!!T,Se=U?.attributes||{},ye=Se.header_image_url_desktop||Se.image_url||null,ge=I&&A,{inlineCurationModeIsOn:Ne,handleInlineCurationModeChange:fe}=((e,a)=>{const t=(0,c.W6)(q.pg),[n,l]=(0,i.useState)(e&&0===a&&t),{scrollNodeChildRef:r}=(0,i.useContext)(Y.VX),s=(0,i.useRef)(n);return(0,i.useEffect)((()=>{const e=!s.current;r&&e&&n&&r.current?.scrollIntoView({block:"end",behavior:"smooth"}),s.current=n}),[r,n]),{inlineCurationModeIsOn:n,handleInlineCurationModeChange:e=>{l(e)}}})(ge,p),he=a.canFilter&&p>0,Fe=a.canSort&&p>0,{tracklistDomRef:Te,handleKeyDown:Re}=(0,Q.Q)(),Ce=(0,K.k)(),Ie=Ce&&p>0,{productState:Ae}=(0,n.v9)(W.Gg),Le=!!Ae&&parseInt(Ae.ads,10)>0,De=(0,n.I0)(),Ue=(0,l.k6)(),we="POP"!==Ue.action?new URLSearchParams(Ue.location.search).get("uid"):null,[xe,Pe]=(0,C.Z)(t),Me=(0,z.o)(),{filter:Be}=(0,i.useContext)(M.fo),{sortState:_e}=(0,i.useContext)(B.Gb),Oe=(0,i.useRef)(null),[Ve]=k,Ze=(0,ee.Z)(null!==ye?ye:Ve?.url||null),Qe=i.useMemo((()=>le.actionBarFactory()),[le]),{isPlaying:ze,isActive:Ke,togglePlay:Ge,usePlayContextItem:qe}=(0,te.n)((0,ne.U)(t,(0,P._j)(_e),Be),{featureIdentifier:"playlist"}),We=(0,i.useCallback)((()=>{const e=(0,G.aK)({isPlaying:ze,isActive:Ke,spec:Qe.playButtonFactory(),logger:se,uri:t});Ge({loggingParams:e})}),[ze,Ke,Ge,Qe,se,t]),Xe=(0,i.useCallback)((async()=>{Me({targetUri:t,intent:xe?"unsave":"save",type:"click"});try{await Pe(!xe)}catch{}}),[xe,Me,Pe,t]),je=(0,i.useCallback)((()=>{const e=Qe.shareButtonFactory().hitShare({entityToBeShared:t,shareId:""});se.logInteraction(e)}),[Qe,se,t]),He=(0,i.useCallback)((()=>{let e;const a=Qe.heartButtonFactory();e=xe?a.hitRemoveLike({itemNoLongerLiked:t}):a.hitLike({itemToBeLiked:t}),se.logInteraction(e),Xe()}),[Qe,Xe,xe,se,t]),Je=(0,i.useCallback)((e=>{const a=e.split(/[\r\n]+/g).map((e=>s().from(e))).filter((e=>s().isTrack(e)||s().isEpisode(e)||s().isLocalTrack(e)));if(a.length>0&&I){const e=a.map((e=>e.toURI())),i=Oe.current?.getSelected()?.slice(-1)?.[0],n={after:i?.uid||"end"};De((0,u.jV)(t,e,n))}}),[I,De,t]);(0,ae.aw)(Je);const $e=(0,i.useCallback)(((e,a)=>{const i=[...a[Z.aN[s().Type.TRACK]]||[],...a[Z.aN[s().Type.LOCAL]]||[],...a[Z.aN[s().Type.EPISODE]]||[],...a[Z.aN[s().Type.ALBUM]]||[]];i.length>0&&(se.logInteraction(le.dragAddToPlaylist({playlist:t,itemToBeAdded:i[0]})),De((0,u.jV)(t,i)),Me({targetUri:t,intent:"add",type:"drop"}))}),[De,Me,t,se,le]);return i.createElement(i.Suspense,{fallback:null},i.createElement(f.$,null,m.ag.get("playlist.page-title",r)),i.createElement(E.Z,{types:[Z.aN[s().Type.TRACK],Z.aN[s().Type.LOCAL],Z.aN[s().Type.EPISODE],Z.aN[s().Type.ALBUM]],onDrop:$e},i.createElement("section",{role:"presentation",className:x.Z.playlist,"data-testid":"playlist-page","data-test-uri":t,onKeyDown:Re},i.createElement(Ee.s,{metadata:e,isPlaying:ze,togglePlay:We,backgroundColor:Ze,spec:ce}),i.createElement("div",{className:x.Z.playlistContent},i.createElement(X.o,{backgroundColor:Ze},i.createElement(X.F,null,L?i.createElement(w.$,{onClick:We,isPlaying:ze,size:H.qE.lg,uri:t,ariaPlayLabel:m.ag.get("playlist.a11y.play",r),ariaPauseLabel:m.ag.get("playlist.a11y.pause",r)}):null,v&&R&&i.createElement(O.v,{uri:t,renderEnabled:()=>i.createElement(_.v,{uri:t})}),v?null:i.createElement(F.r,null,i.createElement(j.H,{isAdded:!!xe,onClick:He,size:j.q.md})),i.createElement(g.o,{uri:t,isFollowing:!!xe,canDownload:Ie,onClick:(e,a)=>(0,G.l7)(a,Qe.downloadButtonFactory(),se,t),onFollow:Xe,size:g.q.md}),i.createElement($.F,{property:q.bM,renderNewExperience:()=>e.permissions?.canAdministratePermissions?i.createElement(be,{onClick:je,label:m.ag.get("permissions.invite-collaborators",r),uri:t}):null}),i.createElement(J.y,{onShow:()=>(0,G.qq)(Qe,se),menu:i.createElement(b.X,{uri:t})},i.createElement(N.z,{label:m.ag.get("more.label.context",r)})),he&&Fe&&i.createElement(oe,{spec:Qe},i.createElement(sa,{metadata:e})))),i.createElement("div",{className:"contentSpacing"},Le?i.createElement(y,{playlistUri:t}):null,p>0?i.createElement(i.Suspense,{fallback:null},i.createElement(oe,{spec:de},me?i.createElement(pe,{key:t,ariaLabel:r,nrTracks:p,playlistUri:t,rankType:Se.rank_type||"",scrollToUid:we,usePlayContextItem:qe,tracklistDomRef:Te}):i.createElement(va,{key:t,ariaLabel:r,nrTracks:p,playlistUri:t,playlistName:r,hasDateAdded:V,isCollaborative:S,isMixedMedia:ve,isLive:ue,isBlend:ke,canEdit:ge,scrollToUid:we,feedbackPath:Se["dislike-endpoint"],deleteFeedbackPath:Se["delete-endpoint"],usePlayContextItem:qe,tracklistRef:Oe,tracklistDomRef:Te,nrCollaborators:ie?.count,canRemove:A,spec:de}))):i.createElement(i.Suspense,{fallback:null},i.createElement($.F,{property:q.pg,renderNewExperience:()=>null,renderOldExperience:()=>i.createElement(h.u,{message:m.ag.get("playlist.empty_state_subtitle"),title:m.ag.get("playlist.empty_state_title"),linkTo:"/browse/newreleases",linkTitle:m.ag.get("browse.new-releases"),renderInline:!0},i.createElement(D.Z,null))})),v?i.createElement(i.Suspense,{fallback:null},i.createElement($.F,{property:q.pg,renderNewExperience:()=>Ne?i.createElement(ia,{playlistUri:t,onCurationModeChange:fe}):i.createElement("button",{className:x.Z.seeMore,onClick:()=>{fe(!0)}},i.createElement(o.Dy,{as:"div",variant:"minuetBold"},m.ag.get("playlist.curation.find_more"))),renderOldExperience:()=>null})):null,v&&!Ne&&Ce?i.createElement(ba,{playlistUri:t,playlistLength:e.totalLength}):null)))))})),ha=i.memo((function(){const{playlistId:e}=(0,l.UO)(),{search:a}=(0,l.TH)(),t=(0,c.W6)(q.bM),r=(0,i.useContext)(ie.ZF).getCapabilities(),o=s().playlistV2URI((e||"").split("&")[0]).toURI(),{isAnonymous:d}=(0,n.v9)(W.Gg),{isEnhanced:u}=(0,V.U)(o);(0,i.useEffect)((()=>{const e=new URLSearchParams(a).get("prid");if(!d&&e){const a=`https://spclient.wg.spotify.com/algotorial-sharing-service/v1/shared?playlistId=${o}&sharedEntityUri=${e}`;(0,le.k)().request(a,{method:"POST",authorize:!0,allowOffline:!0})}}),[o,d,a]);const k=(0,ie.ET)(o,{decorateFormatListData:!0,withSync:!0,hydrateCollaboratorsWithMembers:t});if(!k)return i.createElement(U.h,{hasError:!1,errorMessage:m.ag.get("error.not_found.title.playlist"),loadOffline:r.canModifyOffline});if(k.permissions&&!k.permissions.canView)return i.createElement(L,{uri:o});const p=i.createElement(B.kz,{uri:o},i.createElement(M.hz,{uri:o},i.createElement(fa,{metadata:k,capabilities:r})));return i.createElement(O.v,{uri:o,renderEnabled:()=>u?i.createElement(i.Suspense,{fallback:null},i.createElement(B.kz,{uri:o},i.createElement(Ea,{metadata:k,capabilities:r,featureIdentifier:"playlist"}))):p,renderDisabled:()=>p})}))},53538:(e,a,t)=>{t.d(a,{aK:()=>r,l7:()=>l,qq:()=>n});var i=t(69010);const n=(e,a)=>{const t=e.contextMenuButtonFactory().hitUiReveal();a.logInteraction(t)},l=(e,a,t,n)=>{let l;e===i.mc.download?l=a.hitDownload({itemToDownload:n}):e===i.mc.clear?l=a.hitRemoveDownload({itemToRemoveFromDownloads:n}):e===i.mc.notAllowed&&(l=a.hitUiReveal?.()),l&&t.logInteraction(l)},r=({isPlaying:e,isActive:a,spec:t,logger:i,uri:n})=>{let l;return l=e?t.hitPause({itemToBePaused:n}):a?t.hitResume({itemToBeResumed:n}):t.hitPlay({itemToBePlayed:n}),i.logInteraction(l)}}}]);
//# sourceMappingURL=xpui-routes-playlist.js.map