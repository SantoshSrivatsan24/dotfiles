"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[807],{70369:(e,t,n)=>{n.d(t,{$:()=>r.$});var r=n(22578)},89091:(e,t,n)=>{n.r(t),n.d(t,{HOME_REFRESH_TIMEOUT:()=>Be,default:()=>Fe});var r=n(67294),a=n.n(r),l=n(94184),i=n.n(l),o=n(65858),c=n(73526),s=n(20657),u=n(42922),m=n(89294),d=n(92457),f=n(1496),p=n(35808),g=n(1663),E=n(86964),y=n(52686),h=n(35533),v=n(44794),b=n(80624),_=n(24872),P=n(33607),w=n(23716),O=n(74845),k=n(8247);const I="PLAY_AT_FIRST_TAP_HAD_DEFERRED_ACTIONS",T=e=>{const t=(0,_.getEventSenderInstance)(),n=(0,h.x)(e);t.send(n)};function S(e){const t=(0,v.W6)(k.Qs),[n,a]=(0,r.useState)(void 0),[l,i]=(0,r.useState)(void 0),[c,s]=(0,r.useState)(!1),u=(0,w.g)(),m=(0,o.v9)((({session:e})=>e.user&&e.user.id));(0,r.useEffect)((()=>{i(!!window.sessionStorage.getItem(I)&&(window.sessionStorage.removeItem(I),!0))}),[]),(0,r.useEffect)((()=>{m&&(T({category:"play-at-first-tap",label:"log_attempt",os:(0,P.y)(),context:"ab_v3"}),s((e=>!!window.sessionStorage.getItem(`PLAY_AT_FIRST_TAP_APPLIED_${e}`))(m)),(0,O.M)(b.b.getInstance()).then((e=>{a(e.content.items.length>0)})).catch((()=>{T({category:"play-at-first-tap",label:"recently-played-failed",os:(0,P.y)(),context:"ab_v3"}),a(!0)})))}),[m]),(0,r.useEffect)((()=>{if(void 0===n||void 0===l||!e||!m||c)return;const r=!n&&!l;if(r){(e=>{window.sessionStorage.setItem(`PLAY_AT_FIRST_TAP_APPLIED_${e}`,JSON.stringify(!0))})(m);const n=(e=>{const t=e.content.items.find((e=>{const t="CAROUSEL"===e.rendering,n="LIST"===e.rendering&&"shortcuts"!==e.id;return t||n}));if(!t)return;const n=t.content.items.find((e=>!e.publisher||!e.publisher.startsWith("Spotify")));return n&&n.uri})(e);n&&t&&u.play({uri:n},{featureIdentifier:"home",referrerIdentifier:"home"},{paused:!0}),T({category:"play-at-first-tap",label:"play_content",os:(0,P.y)(),context:n||"no_valid_uri_retrieved"})}T({category:"play-state",label:r?"has_valid_state_yes":"has_valid_state_no",os:(0,P.y)(),context:"ab_v3"})}),[c,n,e,l,u,m,t])}var C=n(13983),A=n(29255),L=n(70369),x=n(50114),N=n(17213),j=n(69559),D=n(4236),R=n(13218),B=n(70296),F=n(67154),M=n.n(F),W=n(69518),U=n.n(W),H=n(28342),q=n(91362),z=n(68156),Y=n(37077),G=n(18261),V=n(4232),Z=n(80507),J=n(25988),K=n(13020),$=n(86514),Q=n(16528),X=n(96685),ee=n(43864),te=n(55911),ne=n(46245),re=n(34325),ae=n(18061),le=n(84242),ie=n(56802),oe=n(18171),ce=n(67892),se=n(80418),ue=n(49961);const me="rPV8BmHZXaGIGT2HwvBB",de="nlOU1unbFAd7ZHyeSMTH",fe="jb9xD5ECTqKFK02qe3HZ",pe="Z35BWOA10YGn5uc9YgAp",ge="g3f_cI5usQX7ZOQyDtA9",Ee="jvWzgRWM_y_9FFTYRCcB",ye="zXwER4Lsqq_e7fVVaPkZ",he="WWDxafTPs4AgThdcX5jN",ve="CKxS_0I5yf3i15WAjzvE",be="Tzzq1pG_inwo_oSOdyjb",_e="EzRmGRncgnv1zFgF4dqE",Pe="bPmmKmSPLKMhtJSaUJRX",we="Kcb74zm1aMqGfPxTwO5s",Oe="s9c9x_mJq197U2hBzGtV",ke=a().memo((({images:e=[],fallbackIcon:t=H.e})=>{const n=(0,ue.X)(e),r=null!=n&&n.url?ye:ve;return a().createElement("div",{className:Ee},a().createElement("div",{className:r},a().createElement(se.E,{className:he,src:null==n?void 0:n.url,loading:"lazy",testid:"shortcut-image"},a().createElement(t,{"aria-hidden":!0}))))})),Ie=a().memo((({index:e,item:t,fallbackIcon:n,showPlayButton:l,onContextMenu:o=(()=>{}),onTouchStart:c=(()=>{}),onTouchEnd:s=(()=>{})})=>{var u,m;const d=(0,Q.k6)(),p=(0,ie.o)(),{setColorFromUri:g,resetColor:E}=(0,B.WQ)(),y=(0,re.G3)(t.uri,t.release_date,null===(u=t.resume_point)||void 0===u?void 0:u.resume_position_ms,null===(m=t.resume_point)||void 0===m?void 0:m.fully_played),{spec:h,logger:v}=(0,f.fU)(ee.createDesktopShortcutsPlayNavCardEventFactory,{data:{position:e,uri:t.uri}}),{isPlaying:b,isActive:_,togglePlay:P}=(0,le.n)({uri:t.uri},{featureIdentifier:"home",referrerIdentifier:"home"});function w(){p({targetUri:t.uri,intent:b?"pause":"play",type:"click"});const e=h.playButtonFactory();let n;n=b?e.hitPause({itemToBePaused:t.uri}):_?e.hitResume({itemToBeResumed:t.uri}):e.hitPlay({itemToBePlayed:t.uri}),v.logInteraction(n),P()}const O=(0,r.useCallback)((()=>{p({targetUri:t.uri,intent:"navigate",type:"click"});const e=h.hitUiNavigate({destination:t.uri});v.logInteraction(e),d.push(U().from(t.uri).toURLPath(!0))}),[d,t.uri,v,p,h]),I=(0,r.useCallback)((()=>{g(t.uri)}),[t.uri,g]),T=(0,f.Wi)(h);return a().createElement("div",{ref:T,className:pe,onContextMenu:o,onTouchStart:c,onTouchEnd:s,onMouseEnter:I,onMouseLeave:E},a().createElement(oe.Z,{uri:t.uri,text:t.name,extraClassName:ge},a().createElement(ke,{images:t.images,fallbackIcon:n}),a().createElement("div",{className:be},a().createElement(ce.r,{to:t.uri,onClick:O,title:t.name},a().createElement(X.LF,{as:"p",variant:"balladBold",className:_e},t.name)),y&&a().createElement(re.Rd,{className:Pe}),l&&a().createElement("div",{className:i()(we,{[Oe]:b})},a().createElement(ae.F,{property:k.iY,renderOldExperience:()=>a().createElement(te.JM,{size:te.qE.sm,isPlaying:b,onClick:w}),renderNewExperience:()=>a().createElement(ne.fh,{isPlaying:b,onClick:w})}))),a().createElement("div",{onClick:O,className:fe})))})),Te=a().memo((e=>U().isCollection(e.item.uri)?a().createElement(Ie,M()({},e,{fallbackIcon:H.e})):a().createElement(G._,{menu:a().createElement(K.X,{uri:e.item.uri})},a().createElement(Ie,M()({},e,{fallbackIcon:H.e}))))),Se=a().memo((e=>a().createElement(G._,{menu:a().createElement(V.Y,{uri:e.item.uri})},a().createElement(Ie,M()({},e,{fallbackIcon:q.u}))))),Ce=a().memo((e=>a().createElement(G._,{menu:a().createElement(Z.m,{uri:e.item.uri})},a().createElement(Ie,M()({},e,{fallbackIcon:z.i}))))),Ae=a().memo((e=>a().createElement(G._,{menu:a().createElement($.M,{uri:e.item.uri})},a().createElement(Ie,M()({},e,{fallbackIcon:Y.n,showPlayButton:!1}))))),Le=a().memo((e=>a().createElement(G._,{menu:a().createElement(J.k,{uri:e.item.uri})},a().createElement(Ie,M()({},e,{fallbackIcon:Y.n,showPlayButton:!1})))));const xe=270,Ne=a().memo((({tagline:e,items:t})=>{const{fetchMultipleColors:n}=(0,B.WQ)(),[l,i]=(0,r.useState)({minWidth:xe,itemHeight:80,showPlayButton:!0}),o=!(0,D.k)(),c=(0,r.useRef)(null),u=(()=>{const e=(new Date).getHours();let t=s.ag.get("home.evening");return e>=5&&e<12?t=s.ag.get("home.morning"):e>=12&&e<18&&(t=s.ag.get("home.afternoon")),t})(),m=(0,r.useCallback)((()=>{if(!c.current)return;const e=c.current.offsetWidth,t=e<600?200:xe;const n=Math.min(Math.floor((e+24)/(t+24)),3);i({minWidth:t,showPlayButton:(e-24*(n-1))/n>=xe,itemHeight:e>=858?80:64})}),[]);if((0,j.a)((()=>{m()})),(0,r.useEffect)((()=>{m()}),[m]),(0,r.useEffect)((()=>{const e=(null==t?void 0:t.map(B.lh))||[];n(e)}),[t,n]),o||null==t||!t.length)return null;const d=64===l.itemHeight?12:16;return a().createElement("section",{className:me,"aria-label":u,ref:c},a().createElement(R.r,{title:u,titleVariant:"alto",tagline:e}),a().createElement("div",{className:de,style:{"--min-column-width":`${l.minWidth}px`,"--column-gap":"24px","--row-gap":`${d}px`,"--item-height":`${l.itemHeight}px`}},t.filter(((e,t)=>t<6)).map(((e,t)=>{const n=function(e){const t=(U().from(e)||{}).type;switch(t){case U().Type.ARTIST:return Ce;case U().Type.ALBUM:case U().Type.COLLECTION_ALBUM:return Se;case U().Type.PLAYLIST:case U().Type.PLAYLIST_V2:return Te;case U().Type.SHOW:return Ae;case U().Type.EPISODE:return Le;case U().Type.COLLECTION:return Te;default:return console.warn(`Unable to resolve entity shortcut from ${e} of type "${t||"unknown"}"`),Ae}}(e.uri);return a().createElement(n,{index:t,key:e.id,item:e,showPlayButton:l.showPlayButton,shouldSetBackgroundColor:0===t})}))))})),je=(0,x.P)(Ne,(()=>null),(e=>(0,N.v)({from:"HomeShortcutsGrid",error:e})));var De=n(5001),Re=n(76092);const Be=18e5,Fe=a().memo((()=>{const{isAnonymous:e}=(0,o.v9)(A.Gg),{status:t}=(0,d.h)(m.N9.SIGNUP),n=(0,De.v8)(e,t===m.b_.COMPLETE),{view:l,refreshContents:h}=(0,p.P)(n),{spec:v,UBIFragment:b}=(0,f.fU)(c.createDesktopHomeEventFactory,{data:{identifier:n,uri:"spotify:home"}});(0,C.z)("home"),S(l);const _=(null==l?void 0:l.timestamp)||0;(0,r.useEffect)((()=>{const e=()=>{Date.now()>_+Be&&h()};return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}}),[_,h]);const P=null==l?void 0:l.content.items,[w,O]=(0,r.useMemo)((()=>{const e=[];let t=null;if(Array.isArray(P))for(let n=0;n<P.length;n++){const r=P[n];"shortcuts"===r.id?t=r:e.push(r)}return[t,e]}),[P]);return a().createElement(b,{spec:v},a().createElement(L.$,null,s.ag.get("page.generic-title")),a().createElement(r.Suspense,{fallback:null},a().createElement(y.SearchOnHomeTopBar,null)),l?a().createElement("section",{"data-testid":"home-page"},a().createElement("div",{className:Re.Z.home},a().createElement("div",{className:i()(Re.Z.content,"contentSpacing")},w?a().createElement(b,{spec:v.shortcutsFactory()},a().createElement(u.JL,{value:"headered-grid",key:w.id},a().createElement(je,{items:w.content.items,title:w.name,tagline:w.tag_line}))):null,a().createElement(b,{spec:v.shelvesFactory()},a().createElement(E.c,{spaces:O,viewName:l.name,viewId:n,isAnonymous:e}))))):a().createElement(g.h,{hasError:!1,errorMessage:s.ag.get("error.not_found.title.page")}))}))},86964:(e,t,n)=>{n.d(t,{c:()=>I});var r=n(59713),a=n.n(r),l=n(67294),i=n.n(l),o=n(54543),c=n(18686),s=n(42922),u=n(21794),m=n(96685),d=n(44794),f=n(44503),p=n(67892);const g="EPMDgp7znILo0hvyirzv",E="noUm6pjQ6KWq7mVxYDor",y="PqnKjxzJ1Zvr9qKRlRbO",h="uuBQS9Ym_VPmAQrLhPQb",v=e=>(0,d.W6)(f.sE)?i().createElement(p.Z,{to:e.uri,target:"_blank",className:g},i().createElement("div",{className:E}),i().createElement(m.LF,{className:y,as:"h2",variant:"alto"},e.label),i().createElement(m.LF,{className:h,as:"p",variant:"mesto"},e.tagline)):null,b=e=>i().createElement(l.Suspense,{fallback:null},i().createElement(v,e));var _=n(5001),P=n(1150);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const k=e=>{var t;return null===(t=e.id)||void 0===t?void 0:t.startsWith("scc-corona")},I=({spaces:e,viewName:t,viewId:n,isAnonymous:r})=>{const a=(0,l.useCallback)(((e,t)=>{const r=((e,t)=>{let{uri:n}=e;return e.href.includes("https://api.spotify.com/v1/views/")&&(n=e.href.replace("https://api.spotify.com/v1/views/","spotify:genre:"),n=(0,u.$x)(n),"hub-browse-grid"===t&&(n=n.replace(":view:",":genre:"))),n})(e,n);return i().createElement(o.q,{key:e.href,index:t,entity:O(O({},e),{},{uri:r})})}),[n]),m=(0,l.useCallback)(((e,t)=>i().createElement(s.JL,{key:e.uri||t,value:"card",index:t},i().createElement(o.q,{index:t,entity:e}))),[]),d=(0,l.useCallback)(((e,t)=>"link"===e.type?a(e,t):m(e,t)),[m,a]),f=(0,l.useCallback)((e=>!!k(e)||!((e=>"HEADER"===e.rendering)(e)||0===e.content.total||r&&"uniquely-yours-shelf"===e.id)),[r]);return e&&0!==e.length?e[0].content?i().createElement(i().Fragment,null,e.filter(f).map(((e,t)=>{const r=e.content&&(0,u.pL)((0,u.SK)(e.href));if(e.id===P.RECENTLY_PLAYED_VIEW_ID||e.id===_.uK)return i().createElement(s.JL,{value:"headered-grid",index:t,key:e.id},i().createElement(P.RecentlyPlayed,{showAll:!1,index:t}));if(k(e)){const t=e.content.items[0];return t&&t.name&&t.description&&t.href?i().createElement(b,{label:t.name,tagline:t.description,uri:t.href}):null}return i().createElement(s.JL,{value:"headered-grid",index:t,key:e.id},i().createElement(c.q,{total:e.content.total,seeAllUri:r,pageId:n,title:e.name,tagline:e.tag_line||void 0,index:t,id:e.id},e.content.items.map(d)))}))):i().createElement(s.JL,{value:"headered-grid"},i().createElement(c.q,{showAll:!0,title:t,total:(null==e?void 0:e.length)||0,index:0,id:null!=n?n:"spaces-see-all-grid"},null==e?void 0:e.map(d))):null}},35808:(e,t,n)=>{n.d(t,{P:()=>f});var r=n(59713),a=n.n(r),l=n(94321),i=n(29255),o=n(67294),c=n(65858),s=n(43088),u=n(44794),m=n(8247);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const f=e=>{const t=(0,s.n)(),[n,r]=(0,o.useState)((()=>t.getViewFromCache(e))),f=(0,u.W6)(m.Xf),p=(0,c.v9)(l.rZ),{locale:g,overrides:E}=(0,c.v9)(i.Gg),y=(null==E?void 0:E.country)||p,h=(null==E?void 0:E.locale)||g;(0,o.useEffect)((()=>{t.getView(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({country:y,locale:h},f&&{extraTypes:["uri_link"]})).then((e=>{r(e)}))}),[y,h,e,t,f]);return{view:n,getNextPage:(0,o.useCallback)((()=>{t.getMore(e).then((e=>{e&&r(e)}))}),[e,t]),refreshContents:(0,o.useCallback)((()=>{t.getView(e,{country:y,locale:h,ignoreCache:!0}).then((e=>{r(e)}))}),[y,h,e,t])}}}}]);
//# sourceMappingURL=xpui-routes-home.js.map