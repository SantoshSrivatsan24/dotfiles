(()=>{var e,t={6838:e=>{e.exports={af:"af-ZA",am:"am-ET",ar:"ar",az:"az-AZ",bg:"bg-BG",bn:"bn-IN",bho:"bp",cs:"cs-CZ",da:"da-DK",de:"de-DE",el:"el-GR",es:"es-ES","es-419":"es-LA",et:"et-EE",fa:"fa-IR",fr:"fr-FR",fi:"fi-FI",fil:"fp-PH","fr-CA":"fr-CA",gu:"gu-IN",hu:"hu-HU",he:"he-IL",hi:"hi-IN",hr:"hr-HR",id:"id-ID",is:"is-IS",it:"it-IT",ja:"ja-JP",kn:"kn-IN",ko:"ko-KR",lt:"lt-LT",lv:"lv-LV",ml:"ml-IN",mr:"mr-IN",ms:"ms-MY",nb:"nb-NO",ne:"ne-NP",nl:"nl-NL",or:"or-IN","pa-IN":"pa-IN","pa-PK":"pa-PK",pl:"pl-PL","pt-PT":"pt-PT","pt-BR":"pt-BR",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",sr:"sr-RS",sv:"sv-SE",sw:"sw",ta:"ta-IN",te:"te-IN",th:"th-TH",tr:"tr-TR",uk:"uk-UA",ur:"ur",vi:"vi-VN","zh-CN":"zh-CN","zh-TW":"zh-TW",zu:"zu-ZA","ar-EG":"ar-EG","ar-MA":"ar-MA","ar-SA":"ar-SA",eu:"eu-ES",bs:"bs-BA",ca:"ca-ES","zh-HK":"zh-HK","en-GB":"en-GB",gl:"gl-ES",mk:"mk-MK","es-AR":"es-AR","es-MX":"es-MX"}},9430:(e,t,n)=>{"use strict";var s={};n.r(s),n.d(s,{ABORT_LOGIN_TYPE_ACCOUNTS:()=>A,ACCOUNTS_METHODS:()=>P,LOADING:()=>x,LOGIN_BEFORE:()=>E,LOGIN_CLEAR_ERRORS:()=>w,LOGIN_FAIL:()=>C,LOGIN_SUCCESS:()=>k,LOGIN_TYPE_ACCOUNTS:()=>N,LOGIN_TYPE_AUTOLOGIN:()=>I,LOGIN_TYPE_EMAIL:()=>T,UTM_PARAMETERS:()=>v,abortLoginWithAccounts:()=>U,fetchUTMParameters:()=>G,loading:()=>O,login:()=>L,loginClearErrors:()=>W,loginFailed:()=>M,loginSuccess:()=>F,loginWithAccounts:()=>R,receivedUTMParameters:()=>B});var r={};n.r(r),n.d(r,{ENTER_LOGIN_MODE:()=>Y,ENTER_SETTINGS_MODE:()=>z,ENTER_SIGNUP_MODE:()=>$,ENTER_SIGNUP_MODE_STEP_0:()=>H,ENTER_SIGNUP_MODE_STEP_1:()=>K,ENTER_WELCOME_MODE:()=>q,INTERACTION:()=>J,START_APP:()=>V,enterLoginMode:()=>te,enterSettingsMode:()=>se,enterSignupMode:()=>Z,enterSignupModeStep0:()=>Q,enterSignupModeStep1:()=>ee,enterWelcomeMode:()=>ne,interaction:()=>ie,openSignupPage:()=>re,startApp:()=>X});var i={};n.r(i),n.d(i,{CLEAR_ALL_ERRORS:()=>Ie,COUNTRY_NOT_LAUNCHED:()=>Te,FACEBOOK_SIGNUP_ATTEMPT:()=>ye,FACEBOOK_SIGNUP_FAILURE:()=>ke,FACEBOOK_SIGNUP_SUCCESS:()=>Ee,SIGNUP_ATTEMPT:()=>fe,SIGNUP_FAILURE:()=>be,SIGNUP_RESTRICTIONS_FAILURE:()=>_e,SIGNUP_RESTRICTIONS_SUCCESS:()=>me,SIGNUP_SUCCESS:()=>Se,UPDATE_SIGNUP_DATA:()=>ve,VALIDATE_FIELD_ATTEMPT:()=>we,VALIDATE_FIELD_FAILURE:()=>Ce,VALIDATE_FIELD_SUCCESS:()=>xe,clearAllErrors:()=>Ke,countryNotLaunched:()=>He,facebookSignup:()=>Re,facebookSignupFailure:()=>Ge,facebookSignupSuccess:()=>Ue,getSignupRestrictions:()=>Ne,signup:()=>De,signupAttempt:()=>Me,signupFailure:()=>je,signupRestrictionsFailure:()=>Pe,signupRestrictionsSuccess:()=>Ae,signupSuccess:()=>Oe,signupWithAccounts:()=>Le,updateSignupData:()=>$e,validateField:()=>Fe,validateFieldAttempt:()=>Be,validateFieldFailure:()=>We,validateFieldSuccess:()=>Ve});var o={};n.r(o),n.d(o,{SETTINGS_FETCH_PROXY_SETTINGS_FAILURE:()=>dt,SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS:()=>lt,SETTINGS_RESTART_CLIENT_FAILURE:()=>gt,SETTINGS_RESTART_CLIENT_SUCCESS:()=>pt,SETTINGS_UPDATE_PROXY_SETTINGS_FAILURE:()=>ut,SETTINGS_UPDATE_PROXY_SETTINGS_SUCCESS:()=>ct,fetchProxySettings:()=>ht,restartClient:()=>_t,updateProxySettings:()=>mt});var a=n(7995),l=n(3742),d=n(7646),c=n(8943),u=n(3925);const p=e=>n.g&&"function"==typeof n.g._getSpotifyModule?new Promise(((t,s)=>{n.g._getSpotifyModule("bridge").executeRequest(JSON.stringify(e),{onSuccess:t,onFailure:s})})):null,g=window.localStorage,h="lastUsername",m="THIS_USER_DOES_NOT_EXIST_AND_IS_A_PLACEHOLDER",_="utmParameters",f=g.getItem(_),b=g.getItem(h),S={errorData:null,loginInProgress:!1,redirectTo:null,username:b!==m?b:"",utmParameters:f?JSON.parse(f):null};const y=function(e=S,t){switch(t.type){case ft.LOADING:return{...e,loading:!0,throbberDelay:t.throbberDelay};case ft.LOGIN_FAIL:return{...e,loading:!1,errorData:t.errorData,loggedIn:!1,loginInProgress:!1};case ft.LOGIN_BEFORE:return{...e,errorData:t.errorData,loggedIn:!1,loginInProgress:t.loginInProgress,username:t.username};case ft.LOGIN_SUCCESS:return{...e,loading:!1,loggedIn:!0,redirectDelay:t.redirectDelay||0,redirectTo:t.redirectTo,username:t.username};case ft.UTM_PARAMETERS:return{...e,utmParameters:t.utmParameters};case ft.LOGIN_CLEAR_ERRORS:return{...e,errorData:null};default:return e}},E="LOGIN_BEFORE",k="LOGIN_SUCCESS",w="LOGIN_CLEAR_ERRORS",C="LOGIN_FAIL",x="LOADING",v="UTM_PARAMETERS",T="login",I="autologin",N="login-accounts",A="abort-login-accounts",P={facebook:"facebook",apple:"apple",google:"google"};function D(e,t=T){return{type:E,errorData:null,username:e||"",loginInProgress:t===T,loginType:t}}function F(e,t,n=T,s=!1,r){return{type:k,errorData:null,redirectTo:r,redirectDelay:t||0,username:e,loginType:n,afterSignup:s}}function M(e,t=T){return{type:C,errorData:e,loginType:t}}function O(e){return{type:x,throbberDelay:e&&e.throbberDelay?e.throbberDelay:0}}const j=async(e,t,{defaultErrorCode:n,redirectDelay:s=0}={},r=T,i=!1,o=null,a=!0)=>{o&&(t.args=t.args||[],t.args[0]=t.args[0]||{},t.args[0].actionHash=o);try{const n=JSON.parse(await p(t)).redirectTo||"xpui";let o=null;t&&t.args&&t.args[0]&&(o=t.args[0].username),e(F(a?o:m,s,r,i,n))}catch(t){let s=t;n?s={errorCode:n}:"string"==typeof t&&(s=JSON.parse(t)),e(M(s,r))}};function L({username:e,password:t,rememberMe:n},s=!1,r=null){return i=>{const o=s?I:T;i(D(n?e:m,o));j(i,{name:T,args:[{username:e,password:t,rememberMe:n}]},{redirectDelay:200},o,s,r,n)}}function R(e,t){return n=>{n(D(null,N));j(n,{name:N,args:[{method:e,enableSignup:!1}]},{redirectDelay:200},N,!1,t)}}function U(){return async()=>{await p({name:A,args:[]})}}function G(){return async e=>{e(B(JSON.parse(await p({name:"get-signup-utm-parameters",args:[]}))))}}function B(e){return{type:v,utmParameters:e}}function W(){return{type:w}}const V="START_APP",$="ENTER_SIGNUP_MODE",H="ENTER_SIGNUP_MODE_STEP_0",K="ENTER_SIGNUP_MODE_STEP_1",Y="ENTER_LOGIN_MODE",q="ENTER_WELCOME_MODE",z="ENTER_SETTINGS_MODE",J="INTERACTION";function X(){return{type:V}}function Z(e=null){return{type:$,actionHash:e}}function Q(){return{type:H}}function ee(){return{type:K}}function te(e=null){return{type:Y,actionHash:e}}function ne(e=null){return{type:q,errorMessage:e}}function se(){return{type:z}}function re(e=!1){return async(t,n)=>{let s,r={};switch(e?"website":"desktop-app"){case"desktop-app":t(Z());break;case"website":{await t(G());const e=n();r=e.login.utmParameters||{utm_source:"spotify",utm_medium:"desktop-unknown",utm_campaign:"organic",referral:""};const i=Object.keys(r).reduce(((e,t)=>(e[t]=encodeURIComponent(r[t]),e)),{});s=`https://www.spotify.com/signup?utm_source=${i.utm_source}&utm_medium=${i.utm_medium}&utm_campaign=${i.utm_campaign}`,i.referral&&(s+=`&referral=${i.referral}&referrer=${i.referral}`),window.open(s);break}}}}function ie(e,t,n,s,r){return{type:J,page:e,interactionType:t,intent:n,itemId:s,actionHash:r}}var oe=n(8961),ae=n.n(oe);function le(){const e="undefined"!=typeof window&&window.__spotify&&window.__spotify.DESKTOP_SIGNUP_DEBUG_KEY;return e||"4c7a36d5260abca4af282779720cf631"}function de(){const e="undefined"!=typeof window&&window.__spotify&&window.__spotify.client_version||"";if(!e)throw new Error("Missing Spotify App Version! Something is wrong: talk to #desktop-squad.");return["Spotify-App-Version",e]}function ce(){const e="undefined"!=typeof window&&window.navigator&&window.navigator.platform||"";let t="";if(-1!==e.indexOf("Mac")?t="OSX":-1!==e.indexOf("Win")?t="Win32":-1!==e.indexOf("Linux")&&(t="Linux"),!t)throw new Error("Missing App Platform! Something is wrong: talk to #desktop-squad.");return["App-Platform",t]}function ue(e){const t=new Map(Object.entries(e).sort()),n=function(e){const t=ae().create();return e.forEach((e=>{void 0!==e&&t.update(e.toString())})),t.hex()}(t);if(t.size>n.length)return t;const s=[...t],r=[...Array(t.size).keys()].sort((function(e,t){const r=n.charAt(e).localeCompare(n.charAt(t));return 0!==r?r:s[e][0].localeCompare(s[t][0])})),i=new Map;return r.forEach((function(e){i.set(s[e][0],s[e][1])})),i}const pe=e=>async(t,n,s)=>{const r=function({name:e,email:t,password:n,gender:s,birthDate:r={},sendEmail:i,shareData:o,agreeEula:a}={},l={utm_source:"spotify",utm_medium:"desktop-unknown",utm_campaign:"organic",referral:""},d=!1){const c=Object.keys(l).reduce(((e,t)=>(e[t]=encodeURIComponent(l[t]),e)),{});let u=`https://login.app.spotify.com?utm_source=${c.utm_source}&utm_medium=${c.utm_medium}&utm_campaign=${c.utm_campaign}`;c.referral&&(u+=`&referral=${c.referral}&referrer=${c.referral}`);const p={key:le(),displayname:e,email:t,password:n,password_repeat:n,gender:s,birth_year:r.year,birth_month:r.month,birth_day:r.day,iagree:a?1:0,creation_point:u,creation_flow:"desktop",platform:"desktop",referrer:c.referral};return"boolean"==typeof i&&(p["send-email"]=i),"boolean"==typeof o&&(p.thirdpartyemail=o),d&&Object.keys(p).forEach((e=>{void 0===p[e]&&delete p[e]})),ue(p)}(t,n,s),i=new FormData;r.forEach(((e,t)=>{i.append(t,e)}));const o=[de(),ce()].reduce(((e,t)=>(e[t[0]]=t[1],e)),{}),a={method:"POST",body:i,headers:{"App-Platform":o["App-Platform"],"Spotify-App-Version":o["Spotify-App-Version"],"X-Client-Id":{}.SPOTIFY_CLIENT_ID}},l=new Request(e,a);((e,t)=>{const n=e.headers.get("content-type");e.headers.set("content-type",((e,t)=>[...e.split(";"),t].join(";"))(n,t))})(l,"charset=utf-8");const d=await fetch(l),{errors:c,...u}=await d.json()||{};if(c)throw c;return u},ge=pe("https://spclient.wg.spotify.com/signup/public/v1/account/"),he=pe("https://spclient.wg.spotify.com/signup/public/v1/account/?validate=true");const me="SIGNUP_RESTRICTIONS_SUCCESS",_e="SIGNUP_RESTRICTIONS_FAILURE",fe="SIGNUP_ATTEMPT",be="SIGNUP_FAILURE",Se="SIGNUP_SUCCESS",ye="FACEBOOK_SIGNUP_ATTEMPT",Ee="FACEBOOK_SIGNUP_SUCCESS",ke="FACEBOOK_SIGNUP_FAILURE",we="VALIDATE_FIELD_ATTEMPT",Ce="VALIDATE_FIELD_FAILURE",xe="VALIDATE_FIELD_SUCCESS",ve="UPDATE_SIGNUP_DATA",Te="COUNTRY_NOT_LAUNCHED",Ie="CLEAR_ALL_ERRORS";function Ne(){return async(e,t)=>{const n=t();try{e(Ae(window.__spotify&&!0===window.__spotify.is_running_on_teamcity?{}:await(async()=>{const e=await fetch("https://spclient.wg.spotify.com/signup/public/v1/account/?validate=1"),t=await e.json()||{};if(t.errors&&t.errors.length>0)throw t.errors;return t})()))}catch(t){e(Pe(t)),n.app&&n.app.mode&&"welcome"!==n.app.mode&&(e(te()),e(re(!0)))}}}function Ae(e){return{type:me,restrictions:e}}function Pe(e){return{type:_e,error:e}}function De(e=null){return async(t,n)=>{t(Me()),await t(G());const s=n().signup.formData,r=n().login.utmParameters;try{await ge(s,r),t(Oe());const{email:n,password:i}=s;t(L({username:n,password:i,rememberMe:!0},!0,e))}catch(e){const n={};Object.keys(e).forEach((t=>{n["birthdate"===t?"birthDate":t]={message:e[t]}})),t(je(n))}}}function Fe(e){return async(t,n)=>{await t(G());const s=n().signup.formData[e],r=n().login.utmParameters;t(Be(e,s));try{await he({[e]:s},r,!0)}catch(n){n[e]&&t(We(e,{message:n[e]}))}}}function Me(){return{type:fe}}function Oe(){return{type:Se}}function je(e){return{type:be,errors:e}}function Le(e,t=null){return n=>{const s={name:N,args:[{method:e,enableSignup:!0}]};n(Re()),(async(e,t,n=null)=>{n&&(t.args=t.args||[],t.args[0]=t.args[0]||{},t.args[0].actionHash=n);try{const n=JSON.parse(await p(t)).redirectTo||"xpui";e(Ue()),e(F(null,0,I,!0,n))}catch(t){let n=t;"string"==typeof t&&(n=JSON.parse(t)),e(Ge(n))}})(n,s,t)}}function Re(){return{type:ye}}function Ue(){return{type:Ee}}function Ge(e){return{type:ke,errorData:e}}function Be(e,t){return{type:we,field:e,value:t}}function We(e,t){return{type:Ce,field:e,error:t}}function Ve(e){return{type:xe,field:e}}function $e(e){return{type:ve,data:e}}function He(){return{type:Te}}function Ke(){return{type:Ie}}var Ye=n(6838),qe=n.n(Ye);let ze,Je,Xe;!function(e){e.af="af",e.am="am",e.ar="ar",e.az="az",e.bg="bg",e.bn="bn",e.bho="bho",e.ca="ca",e.cs="cs",e.da="da",e.de="de",e.el="el",e.en="en",e.es419="es-419",e.es="es",e.et="et",e.fa="fa",e.fi="fi",e.fil="fil",e.frCA="fr-CA",e.fr="fr",e.gu="gu",e.he="he",e.hi="hi",e.hr="hr",e.hu="hu",e.id="id",e.is="is",e.it="it",e.ja="ja",e.kn="kn",e.ko="ko",e.lt="lt",e.lv="lv",e.ml="ml",e.mr="mr",e.ms="ms",e.nb="nb",e.ne="ne",e.nl="nl",e.or="or",e.paIN="pa-IN",e.paPK="pa-PK",e.pl="pl",e.ptBR="pt-BR",e.ptPT="pt-PT",e.ro="ro",e.ru="ru",e.sk="sk",e.sl="sl",e.sr="sr",e.sv="sv",e.sw="sw",e.ta="ta",e.te="te",e.th="th",e.tr="tr",e.uk="uk",e.ur="ur",e.vi="vi",e.zhCN="zh-CN",e.zhTW="zh-TW",e.zu="zu"}(ze||(ze={})),function(e){e.AR="، ",e.FA="، ",e.EN=", "}(Je||(Je={})),function(e){e.ZERO="zero",e.ONE="one",e.TWO="two",e.FEW="few",e.MANY="many",e.OTHER="other"}(Xe||(Xe={}));let Ze={};function Qe(e){return"number"==typeof e?e.toString():e.replace(/\$/,"$$$$")}const et=e=>"ar"===e?"ar-u-nu-latn":e;const tt=new class{_relativeTimeFormat=void 0===Intl.RelativeTimeFormat?null:new Intl.RelativeTimeFormat;_dateTimeFormats=new Map;constructor(){this._dictionary={},this._locale=ze.en}getDateTimeFormat(e){const t=JSON.stringify(Object.keys(e).sort().map((t=>({[t]:e[t]}))));let n=this._dateTimeFormats.get(t);return void 0===n&&(n=new Intl.DateTimeFormat(et(this._locale),e),this._dateTimeFormats.set(t,n)),n}getDictionary(){return this._dictionary}setDictionary(e){this._dictionary=e}setLocale(e){this._locale=e,this._dateTimeFormats.clear()}getLocale(){return this._locale}getSmartlingLocale(){const e=this._locale;return qe()[e]||e}toLocaleLowerCase(e){return e?.toLocaleLowerCase(this._locale)}toLocaleUpperCase(e){return e?.toLocaleUpperCase(this._locale)}get(e,...t){const n=e in this._dictionary?this._dictionary[e]:e;let s="";if("string"!=typeof n){const e=t[0],r=((e,t)=>{try{return(Ze[e]||(Ze[e]=new Intl.PluralRules(e))).select(t)}catch{return Xe.OTHER}})(this._locale,parseInt(e,10)),i=n[r];void 0!==i?s=i:n.other&&(s=n.other)}else s=n;if(/%\d%/.test(s)){if(!["desktop.login.DefaultErrorMessage","desktop.login.ErrorProxyAuthRequired","desktop.login.MissingUserInfoMessage","desktop.login.RegionMismatchMessage","desktop.login.ClientUpdateFail","desktop.login.FbUserNotFoundSignUp","desktop-auth.error"].includes(e))throw new Error("i18n: The placeholder format %0% is legacy and is only allowed for existing strings.")}if(t?.length>0)for(let e=0;e<t.length;e++){const n=t[e];if(null!=n)if("string"==typeof n)s=s.replace(`{${e}}`,Qe(n)).replace(`%${e}%`,Qe(n));else if("number"==typeof n){const t=this.formatNumber(n);s=s.replace(`{${e}}`,t).replace(`%${e}%`,t)}else if("object"==typeof n)for(const e of Object.keys(n)){const t=n[e];s=s.replace(`%${e}%`,Qe(t))}}return s}getSeparator(){switch(this._locale){case ze.ar:return Je.AR;case ze.fa:return Je.FA;default:return Je.EN}}formatNumber(e,t){return e.toLocaleString(et(this._locale),t)}formatNumberCompact(e){return this.formatNumber(e,{notation:"compact",maximumFractionDigits:1})}formatDate(e,t=null){const n=t||{year:"numeric",month:"long",day:"numeric"};return this.getDateTimeFormat(n).format(e)}formatRelativeDate(e,t=null){const n=new Date(Date.now()),s=(e=new Date(e)).getTime()-n.getTime();if(Math.abs(s)<2592e6&&null!==this._relativeTimeFormat){const{days:e,hours:t,minutes:n,seconds:i}=(r=s,{seconds:Math.round(r/1e3),minutes:Math.round(r/1e3/60),hours:Math.round(r/1e3/60/60),days:Math.round(r/1e3/60/60/24)});return e||t||n?e||t?e?this._relativeTimeFormat.format(e,"days"):this._relativeTimeFormat.format(t,"hours"):this._relativeTimeFormat.format(n,"minutes"):this._relativeTimeFormat.format(i,"seconds")}var r;return this.formatDate(e,t)}__resetForTests(){this._dictionary={},this._locale=ze.en,Ze={}}},nt=2,st=3,rt=4,it={"auto-detect":{label:()=>tt.get("desktop.settings.proxy.autodetect")},"no-proxy":{label:()=>tt.get("desktop.settings.proxy.noproxy")},http:{label:()=>tt.get("desktop.settings.proxy.http")},socks4:{label:()=>tt.get("desktop.settings.proxy.socks4")},socks5:{label:()=>tt.get("desktop.settings.proxy.socks5")}},ot=[{enumKey:"auto-detect",enumValue:0},{enumKey:"no-proxy",enumValue:1},{enumKey:"http",enumValue:2},{enumKey:"socks4",enumValue:3},{enumKey:"socks5",enumValue:4}],at="sp://proxy/v1/";const lt="SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS",dt="SETTINGS_FETCH_PROXY_SETTINGS_FAILURE",ct="SETTINGS_UPDATE_PROXY_SETTINGS_SUCCESS",ut="SETTINGS_UPDATE_PROXY_SETTINGS_FAILURE",pt="SETTINGS_RESTART_CLIENT_SUCCESS",gt="SETTINGS_RESTART_CLIENT_FAILURE";function ht(){return e=>{(async function(){return new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"GET",uri:at}),persistent:!1,onSuccess:n=>{const s=JSON.parse(n);200!==s.status&&t(new Error(`Failed to fetch proxy settings (status code: ${s.status})`));const r=JSON.parse(s.body);e({mode:r["network.proxy.mode"],address:r["network.proxy.addr"],username:r["network.proxy.user"],password:r["network.proxy.pass"]})},onFailure:(e,n)=>{t(e)}})}))})().then((t=>{e(function(e){return{type:lt,data:e}}(t))}),(t=>{e(function(e){return{type:dt,error:e}}(t))}))}}function mt(e){return t=>{(async function(e){return new Promise(((t,n)=>{const s={"network.proxy.mode":e.mode};[nt,st,rt].includes(e.mode)&&(s["network.proxy.addr"]=e.address,s["network.proxy.user"]=e.username),[nt,rt].includes(e.mode)&&(s["network.proxy.pass"]=e.password),window.sendCosmosRequest({request:JSON.stringify({method:"PUT",uri:at,body:JSON.stringify(s)}),persistent:!1,onSuccess:()=>{t()},onFailure:(e,t)=>{n(e)}})}))})(e).then((()=>{t({type:ct}),t(ht())}),(e=>{t(function(e){return{type:ut,error:e}}(e))}))}}function _t(){return e=>{(async function(){return new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"POST",uri:"sp://desktop/v1/restart"}),persistent:!1,onSuccess:()=>{e()},onFailure:(e,n)=>{t(e)}})}))})().then((()=>{e({type:pt})}),(t=>{e(function(e){return{type:gt,error:e}}(t))}))}}const ft={...r,...s,...i,...o};var bt=n(9496),St=n(4637);class yt extends bt.Component{constructor(e){super(e),this.state={hidden:this.props.delay>0}}componentDidMount(){!0===this.state.hidden&&(this.throbberTimeout=setTimeout((()=>{this.setState({hidden:!1})}),this.props.delay))}componentWillUnmount(){this.throbberTimeout&&clearTimeout(this.throbberTimeout)}render(){return this.state.hidden?null:(0,St.jsx)("div",{"data-testid":"glue-throbber",className:"GlueThrobber "+(this.props.initial?"throbber-initial":"throbber"),children:(0,St.jsx)("div",{})})}}yt.defaultProps={delay:0,initial:!0};var Et=n(5530),kt=n.n(Et);function wt(){return kt().create().toString()}var Ct=n(5003),xt=n(2075);class vt extends bt.PureComponent{constructor(e){super(e),this.handleLoginClick=this.handleLoginClick.bind(this),this.handleErrorClick=this.handleErrorClick.bind(this)}handleLoginClick(){const e=wt();this.props.openLoginPage(e),this.props.onInteraction("login/welcome","click","open-page-login",null,e)}handleErrorClick(e){if(e.target.getAttribute("data-action")){"showSettings"===e.target.getAttribute("data-action")&&this.props.openSettingsPage()}}render(){const{errorMessage:e}=this.props;return(0,St.jsxs)("main",{className:"Welcome","data-testid":"welcome",children:[(0,St.jsxs)("h1",{className:"HeroText __welcome",children:[tt.get("desktop-auth.login.millions-of-songs"),(0,St.jsx)("br",{}),tt.get("desktop-auth.login.free-on-spotify")]}),(0,St.jsxs)("div",{className:"Welcome__signup-or-login",children:[e&&(0,St.jsxs)("div",{className:"Welcome__error-message",role:"alert",onClick:this.handleErrorClick,"aria-live":"assertive",children:[(0,St.jsx)(Ct.l,{className:"Welcome__error-message__icon"}),(0,St.jsx)("span",{dangerouslySetInnerHTML:{__html:e}})]}),(0,St.jsx)(xt.D,{id:"login-button",onClick:this.handleLoginClick,"data-ta-id":"welcome-login-button","data-testid":"login-button",fullWidth:!0,children:tt.get("desktop.login.LoginButton")})]})]})}}const Tt=(0,d.$j)((e=>({errorMessage:e.app.errorMessage})),(e=>({openLoginPage:t=>e(ft.enterLoginMode(t)),openSettingsPage:()=>e(ft.enterSettingsMode()),onInteraction:(t,n,s,r,i)=>e(ft.interaction(t,n,s,r,i))})))(vt);var It=n(652),Nt=n(5549);const At="https://www.spotify.com/redirect/account-page/",Pt="showSettings",Dt={id:"UnknownLoginErrorMessage"},Ft={id:"DefaultErrorMessage",replace:[Pt]},Mt={127:{id:"SessionTerminatedMessage"},3:{id:"BadCredentialsMessage"},4:{id:"ErrorResolvingDNS"},53:{id:"ErrorProxyUnauthorized"},54:{id:"ErrorProxyForbidden"},55:{id:"ErrorProxyAuthRequired",replace:[Pt]},400:Dt,401:Dt,402:{id:"CriticalUpdate"},403:{id:"UserBannedMessage"},404:Dt,405:Dt,406:{id:"UserNotAllowedOnPlatformMessage"},407:{id:"MissingUserInfoMessage",replace:[At]},408:{id:"RegionMismatchMessage",replace:[At,"https://www.spotify.com/redirect/upgrade-product/"]},409:{id:"PremiumUsersOnlyMessage"},410:{id:"BadCredentialsMessage"},411:Dt,412:{id:"BadCredentialsMessage"},413:{id:"CreateUserDeniedMessage"},414:Dt,415:Dt,416:Dt,417:{id:"FacebookCredentialsMisusedMessage"},418:Dt,"critical-update-error":{id:"ClientUpdateFail",replace:["https://www.spotify.com/redirect/download/"]}},Ot={1:Dt,2:Dt,3:{id:"BadCredentialsMessage"},4:Dt,5:Dt,6:Dt,7:Dt,8:Dt,9:Dt},jt={1:{silent:!0},2:Dt,3:Dt,4:{id:"SessionExpiredMessage"},5:Ft};function Lt(e,t,n){if(0===t)return!1;if(!e&&!t)return!1;let s=Mt;switch(e){case"session":s=Ot;break;case"desktop_login_accounts":s=jt}const r=s[t]||Ft;if(r.silent)return!1;const i=r.replace||[];let o="";switch(r.id){case"UnknownLoginErrorMessage":o=tt.get("desktop.login.UnknownLoginErrorMessage");break;case"DefaultErrorMessage":o=tt.get("desktop.login.DefaultErrorMessage",i[0]);break;case"SessionTerminatedMessage":o=tt.get("desktop.login.SessionTerminatedMessage");break;case"SessionExpiredMessage":o=tt.get("desktop.login.SessionExpiredMessage");break;case"BadCredentialsMessage":o=tt.get("desktop.login.BadCredentialsMessage");break;case"ErrorResolvingDNS":o=tt.get("desktop.login.ErrorResolvingDNS");break;case"ErrorProxyUnauthorized":o=tt.get("desktop.login.ErrorProxyUnauthorized");break;case"ErrorProxyForbidden":o=tt.get("desktop.login.ErrorProxyForbidden");break;case"ErrorProxyAuthRequired":o=tt.get("desktop.login.ErrorProxyAuthRequired",i[0]);break;case"CriticalUpdate":o=tt.get("desktop.login.CriticalUpdate");break;case"UserBannedMessage":o=tt.get("desktop.login.UserBannedMessage");break;case"UserNotAllowedOnPlatformMessage":o=tt.get("desktop.login.UserNotAllowedOnPlatformMessage");break;case"MissingUserInfoMessage":o=tt.get("desktop.login.MissingUserInfoMessage",i[0]);break;case"RegionMismatchMessage":o=tt.get("desktop.login.RegionMismatchMessage",i[0],i[1]);break;case"PremiumUsersOnlyMessage":o=tt.get("desktop.login.PremiumUsersOnlyMessage");break;case"CreateUserDeniedMessage":o=tt.get("desktop.login.CreateUserDeniedMessage");break;case"ClientUpdateFail":o=tt.get("desktop.login.ClientUpdateFail",i[0]);break;case"FbUserNotFoundSignUp":o=tt.get("desktop.login.FbUserNotFoundSignUp",i[0])}return n?`${o}<br>${tt.get("desktop.login.errorCode",n)}`:o}function Rt({validity:e={}}){return e.valid?null:["valueMissing","typeMismatch","tooShort"].find((t=>e[t]))}const Ut="H5vfurs7KNEs9Io5DUA7",Gt="qfBRU_bttJde7gy46oAB",Bt="ypTrzM1PtlrZp04qs6Eq",Wt="oHZmDpK0SrWDaXhPjUtC",Vt="lAHowB9HYfAUrg9UaSde";var $t=n(6170);const Ht=kt().create().toString(),Kt="has-used-app",Yt=!window.localStorage.getItem(Kt);Yt&&window.localStorage.setItem(Kt,!0);const qt=()=>{const e=g.getItem("utmParameters");let t;try{t=e?JSON.parse(e).referral:""}catch(e){t=""}return t};class zt{constructor(e){this._eventSender=e}logPageView({page:e}){this.logAction({page:e,action_type:"pageview",action_intent:""})}logAction({page:e,action_type:t,action_intent:n,item_id:s,action_hash:r},i){this._eventSender.send((0,$t.e)({action_type:t,action_intent:n,action_page:e,action_item_id:s,action_hash:r,device_is_new_install:Yt,device_locale:window.__spotify.locale,device_referrer:qt(),ab_flags:"",session_id:Ht}),i)}}var Jt;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.OPERATION_ABORTED=1]="OPERATION_ABORTED",e[e.OPERATION_TIMED_OUT=2]="OPERATION_TIMED_OUT",e[e.LOGIN_BAD_CREDENTIALS=3]="LOGIN_BAD_CREDENTIALS",e[e.LOGIN_BAD_APP_KEY=4]="LOGIN_BAD_APP_KEY",e[e.LOGIN_BAD_CLIENT_VERSION_INFO=5]="LOGIN_BAD_CLIENT_VERSION_INFO",e[e.STORAGE_INITIALIZATION_FAILED=6]="STORAGE_INITIALIZATION_FAILED",e[e.MULTIPLE_LOGIN_NOT_ALLOWED=7]="MULTIPLE_LOGIN_NOT_ALLOWED",e[e.OPERATION_CANCELLED=8]="OPERATION_CANCELLED",e[e.BAD_DEVICE_INFO=9]="BAD_DEVICE_INFO",e[e.INTERNAL_ERROR=10]="INTERNAL_ERROR"}(Jt||(Jt={}));const Xt=function({eventSender:e}){const[t,n]=(0,bt.useState)(""),[s,r]=(0,bt.useState)(!1),[i,o]=(0,bt.useState)(!1),a=function(){const e=(0,d.I0)();return()=>{e(se())}}(),l=(0,bt.useRef)(0),c=(0,bt.useMemo)((()=>new zt(e)),[e]);(0,bt.useEffect)((()=>{c.logPageView({page:"auth-on-web"})}),[c]);const u=async t=>{const s=++l.current,i=wt();o(t),n(""),r(!0),c.logAction({page:"auth-on-web",action_type:"click",action_intent:t?"sign-up-with-browser":"log-in-with-browser",action_hash:i});try{await p({name:N,args:[{method:"login-accounts",enableSignup:t,actionHash:i}]}),c.logAction({page:"auth-on-web",action_type:"view",action_intent:t?"show-success-signup":"show-success-login"},{flush:!1}),await e.finalFlush(),location.href="spotify:app:xpui"}catch(e){const i="string"==typeof e?JSON.parse(e):e;if(s!==l.current)return void c.logAction({page:"auth-on-web",action_type:"view",action_intent:t?"sign-up-with-browser-cancelled-by-new-attempt":"log-in-with-browser-cancelled-by-new-attempt",item_id:i?.errorReference});r(!1);let o=Lt(i.errorCategory,i.errorCode,i.errorReference);"desktop_login_accounts"===i.errorCategory&&i.errorCode===Jt.OPERATION_TIMED_OUT&&(o=t?tt.get("desktop-auth.login.signup-time-out"):tt.get("desktop-auth.login.login-time-out")),n(o||""),c.logAction({page:"auth-on-web",action_type:"view",action_intent:t?"show-error-signup":"show-error-login",item_id:i?.errorReference})}};return(0,St.jsx)("main",{children:s?(0,St.jsxs)(St.Fragment,{children:[(0,St.jsx)(It.D,{as:"h1",variant:"alto",semanticColor:"textBase",className:Ut,children:i?tt.get("desktop-auth.login.go-to-browser-signup"):tt.get("desktop-auth.login.go-to-browser-login")}),(0,St.jsxs)("button",{className:Bt,onClick:()=>{r(!1),c.logAction({page:"auth-on-web",action_type:"click",action_intent:"try-again"})},children:[(0,St.jsx)(It.D,{as:"span",variant:"ballad",semanticColor:"textSubdued",children:tt.get("desktop-auth.login.not-seeing-browser")})," ",(0,St.jsx)(It.D,{as:"span",variant:"balladBold",semanticColor:"textBase",children:tt.get("desktop-auth.login.try-again")})]})]}):(0,St.jsxs)(St.Fragment,{children:[(0,St.jsxs)(It.D,{as:"h1",variant:"alto",semanticColor:"textBase",className:Ut,children:[tt.get("desktop-auth.login.millions-of-songs"),(0,St.jsx)("br",{}),tt.get("desktop-auth.login.free-on-spotify")]}),t&&(0,St.jsxs)("div",{className:Wt,role:"alert",onClick:e=>{if(e.currentTarget.getAttribute("data-action")){"showSettings"===e.currentTarget.getAttribute("data-action")&&a()}},"aria-live":"assertive",children:[(0,St.jsx)(Ct.l,{className:Vt}),(0,St.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})]}),(0,St.jsx)(xt.D,{onClick:()=>{u(!1)},iconTrailing:Nt.T,children:tt.get("desktop-auth.login.log-in-with-browser")}),(0,St.jsxs)("button",{className:Gt,onClick:()=>{u(!0)},children:[(0,St.jsx)(It.D,{as:"span",variant:"ballad",semanticColor:"textSubdued",children:tt.get("desktop-auth.login.new-to-spotify")}),(0,St.jsx)(It.D,{as:"span",variant:"balladBold",semanticColor:"textBase",children:tt.get("desktop-auth.login.sign-up-with-browser")}),(0,St.jsx)(Nt.T,{iconSize:16,semanticColor:"textBase"})]})]})})};var Zt=n(1033),Qt=n(5112),en=n(5608),tn=n(4875),nn=n.n(tn);const sn=()=>(0,St.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,St.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8ZM7.25 3V10H8.75V3H7.25ZM7.25 11.5256V13.0256H8.75V11.5256H7.25Z",fill:"#eb6471"})});class rn extends bt.PureComponent{render(){const{errorMessage:e}=this.props;return(0,St.jsxs)("div",{"aria-live":"polite",className:nn()("FieldError",{"FieldError--hidden":!e}),children:[(0,St.jsx)(sn,{}),(0,St.jsx)("span",{children:e||""})]})}}let on=0;class an extends bt.PureComponent{constructor(...e){super(...e),this.idNumber=++on,this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.onChange(e)}render(){const{label:e,placeholderLabel:t,name:n,type:s,isRequired:r,taId:i,id:o,defaultValue:a,value:l,minLength:d,autoFocus:c,hasError:u,isDisabled:p,isHiddenForScreenReaders:g,useCustomStyle:h,className:m,inputClassName:_,inputRef:f,onBlur:b,onFocus:S,onInput:y,onKeyDown:E,onKeyUp:k}=this.props,w=o||`GlueTextInput-${this.idNumber}`;return(0,St.jsx)("label",{className:h?m:"GlueTextInput",htmlFor:w,"aria-label":e,"aria-hidden":!!g||void 0,children:(0,St.jsx)("input",{className:h?_:nn()("GlueTextInput__input",{"GlueTextInput__input--has-error":u}),tabIndex:g?"-1":void 0,type:s,id:w,name:n,"data-ta-id":i,"aria-invalid":u,disabled:p,minLength:d,autoFocus:c,placeholder:t||e,value:a?void 0:l,defaultValue:a,onBlur:b,onFocus:S,onChange:this.handleChange,onInput:a?void 0:y,onKeyDown:E,onKeyUp:k,ref:f,required:r})})}}an.defaultProps={name:"",type:"text",isRequired:!1,taId:"",defaultValue:void 0,value:"",minLength:0,autoFocus:!1,hasError:!1,isDisabled:!1,isHiddenForScreenReaders:!1,useCustomStyle:!1,onBlur(){},onFocus(){},onChange(){},onInput(){},onKeyDown(){}};class ln extends bt.PureComponent{constructor(e){super(e),this.state={isEditing:!1,passwordVisible:!1},this.handleBlur=this.handleBlur.bind(this),this.handleInput=this.handleInput.bind(this)}handleBlur({target:e,relatedTarget:t}){this.setState({isEditing:!1}),t&&(t.name||"submit"===t.type)&&this.validate(e)}handleInput(){this.setState({isEditing:!0})}handleTogglePasswordVisible=()=>{const e=!this.state.passwordVisible;this.setState({passwordVisible:e}),this.props.onTogglePasswordVisibility&&this.props.onTogglePasswordVisibility(e)};validate(e){const{name:t,onValidate:n,noValidate:s}=this.props;!s&&n&&n(t,Rt(e))}renderPasswordEyeToggler(){const{type:e}=this.props,{passwordVisible:t}=this.state;return"password"!==e?null:(0,St.jsxs)(bt.Fragment,{children:[(0,St.jsx)("button",{type:"button",onClick:this.handleTogglePasswordVisible,tabIndex:"-1",className:"FormField--passwordEyeIcon "+(t?"passwordVisible":"")}),(0,St.jsx)("span",{tabIndex:"-1",className:"FormField--passwordEyeIcon--cross "+(t?"passwordVisible":"")})]})}render(){const{error:e={},noValidate:t,label:n,name:s,type:r,value:i,isRequired:o,minLength:a,autoFocus:l,isDisabled:d,onChange:c,onKeyUp:u,onFocus:p,rightIcon:g=null}=this.props,{isEditing:h,passwordVisible:m}=this.state,_=g;let f=r;return"password"===r&&m&&(f="text"),(0,St.jsxs)("div",{className:nn()("FormField",{"FormField--no-validate":t}),children:[(0,St.jsx)(an,{label:n,name:s,type:f,taId:`${s}-field`,value:i,isRequired:o,minLength:a,autoFocus:l,hasError:!!e.message&&!h,isDisabled:d,onChange:c,onFocus:p,onKeyUp:u,onBlur:this.handleBlur,onInput:this.handleInput}),_&&(0,St.jsx)(_,{className:"FormField--rightIcon"}),this.renderPasswordEyeToggler(),!t&&!h&&e.message&&(0,St.jsx)(St.Fragment,{children:(0,St.jsx)(rn,{errorMessage:e.message})})]})}}const dn=(0,d.$j)((()=>({})),(()=>({})))(ln);class cn extends bt.PureComponent{constructor(...e){super(...e),this.handleBlur=this.handleBlur.bind(this)}handleBlur(e={}){this.props.onBlur&&this.props.onBlur(e)}render(){const{type:e="text",name:t,label:n,classes:s,hasError:r,...i}=this.props,o=`${t}-field`;return(0,St.jsxs)("span",{className:s,children:[(0,St.jsx)("label",{className:"glue-hidden-visually",htmlFor:o,children:n}),(0,St.jsx)("input",{...i,onBlur:this.handleBlur,type:e,name:t,id:o,"data-ta-id":o,className:nn()("form-control Input",{"Input--has-error":r}),"aria-invalid":!!r,placeholder:n,required:!0})]})}}const un=(new Date).getFullYear()-120,pn=(e,t,n)=>{let s=null;return((e,t,n)=>[e,t,n].reduce(((e,t)=>e&&!!t),!0))(e,t,n)?((e,t,n)=>{const s=new Date(n,t-1,e);return!(s.getFullYear()<un)&&s.getDate()===e&&s.getMonth()===t-1&&s.getFullYear()===n})(e,t,n)||(s="invalid"):s="incomplete",s},gn={BIG_ENDIAN:"big",LITTLE_ENDIAN:"little",MIDDLE_ENDIAN:"middle"};class hn extends bt.PureComponent{constructor(e){super(e),this.state={isEditing:!1},this.monthStrings=[tt.get("desktop.login.January"),tt.get("desktop.login.February"),tt.get("desktop.login.March"),tt.get("desktop.login.April"),tt.get("desktop.login.May"),tt.get("desktop.login.June"),tt.get("desktop.login.July"),tt.get("desktop.login.August"),tt.get("desktop.login.September"),tt.get("desktop.login.October"),tt.get("desktop.login.November"),tt.get("desktop.login.December")],this.handleInput=this.handleInput.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this)}handleInput({target:{name:e,value:t,validity:n={}}}){this.setState({isEditing:!0});const s=parseInt(t,10);n.valueMissing||!isFinite(t)||isNaN(s)?this.props.onChange({...this.props.value,[e]:void 0}):this.props.onChange({...this.props.value,[e]:s})}handleBlur(e){const t=e.relatedTarget?e.relatedTarget.name:null,n=["day","month","year"].includes(t);this.setState({isEditing:n}),n||this.validate()}handleFocus(e){this.setState({isEditing:!0});const t=e.relatedTarget?e.relatedTarget.name:null;!["day","month","year"].includes(t)&&this.props.onFocus&&this.props.onFocus()}validate(){const{day:e,month:t,year:n}=this.props.value,s=pn(e,t,n,this.props.minAge);this.props.onValidate("birthDate",s)}renderYear(e,t,n){return(0,St.jsx)(cn,{type:"number",name:"year",classes:"FormDate__input FormDate__year",label:tt.get("desktop.login.Year"),autoFocus:n,defaultValue:e||"",onInput:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,min:un,hasError:t.includes("year"),onFocus:this.handleFocus})}renderMonth(e,t,n){return(0,St.jsxs)("select",{name:"month",id:"month-field",className:nn()("form-control Input FormDate__input FormDate__month",{"Input--has-error":t.includes("month")}),autoFocus:n,defaultValue:e||"",required:!0,onChange:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,onFocus:this.handleFocus,children:[(0,St.jsx)("option",{value:"",disabled:!0,hidden:!0,children:tt.get("desktop.login.Month")}),this.monthStrings.map(((e,t)=>(0,St.jsx)("option",{value:t+1,children:e},t)))]})}renderDay(e,t,n){return(0,St.jsx)(cn,{type:"number",name:"day",classes:"FormDate__input FormDate__day",label:tt.get("desktop.login.Day"),autoFocus:n,defaultValue:e||"",onInput:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,min:1,max:31,hasError:t.includes("day"),onFocus:this.handleFocus})}render(){const{name:e,label:t,dateEndianness:n,error:s={},autoFocus:r}=this.props,{day:i,month:o,year:a}=this.props.value,{isEditing:l}=this.state,d=["day","month","year"].filter((e=>!(l||!s.message)&&("incomplete"===s.code?!this.props.value[e]:"tooOld"!==s.code||"year"===e)));let c="";return c="big"===gn[n]?(0,St.jsxs)("div",{className:"FormDate__inputs",children:[this.renderYear(a,d,r),this.renderMonth(o,d),this.renderDay(i,d)]}):"little"===gn[n]?(0,St.jsxs)("div",{className:"FormDate__inputs",children:[this.renderDay(i,d,r),this.renderMonth(o,d),this.renderYear(a,d)]}):(0,St.jsxs)("div",{className:"FormDate__inputs",children:[this.renderMonth(o,d,r),this.renderDay(i,d),this.renderYear(a,d)]}),(0,St.jsxs)("div",{className:"FormDate",children:[(0,St.jsx)("label",{className:`FormDate__label ${e}-label`,htmlFor:"month-field",children:t}),c,!l&&s.message&&(0,St.jsx)(St.Fragment,{children:(0,St.jsx)(rn,{errorMessage:s.message})})]})}}hn.defaultProps={value:{},dateEndianness:"MIDDLE_ENDIAN",minAge:13};const mn=(0,d.$j)((()=>({})),(()=>({})))(hn);class _n extends bt.PureComponent{constructor(e){super(e),this.state={isEditing:!1},this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this)}handleBlur(e){this.state={isEditing:!1};(e.relatedTarget?e.relatedTarget.name:null)!==this.props.name&&this.validate(e.target)}handleFocus(e){this.state={isEditing:!0},this.props.onOptionFocus&&e&&e.target&&this.props.onOptionFocus(e.target.value)}validate(e){const{name:t,onValidate:n}=this.props;n&&n(t,Rt(e))}render(){const{name:e,label:t,options:n,value:s,showTitle:r,error:i={},onValidate:o,onOptionFocus:a,...l}=this.props,{isEditing:d}=this.state,c=`${e}-field`,u=nn()("FormRadioSelect",{"FormRadioSelect--is-disabled":this.props.disabled});return(0,St.jsxs)("div",{className:u,children:[(0,St.jsx)("label",{className:r?"":"glue-hidden-visually",htmlFor:c,children:t}),n.map((t=>{const n=`${t.value}-radio`;return(0,St.jsxs)("span",{className:s===t.value?"checked":"",children:[(0,St.jsx)("input",{...l,name:e,type:"radio",id:n,className:"glue-hidden-visually",value:t.value,checked:s===t.value,onBlur:this.handleBlur,onFocus:this.handleFocus,required:!0,disabled:this.props.disabled}),(0,St.jsx)("label",{className:nn()("FormRadioSelect__label",{"FormRadioSelect__label--has-error":!!i.message}),htmlFor:n,children:t.label})]},t.value)})),!d&&i.message&&(0,St.jsx)(St.Fragment,{children:(0,St.jsx)(rn,{errorMessage:i.message})})]})}}const fn=(0,d.$j)((()=>({})),(()=>({})))(_n);class bn extends bt.PureComponent{constructor(...e){super(...e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.isDisabled||this.props.onChange(e.target.checked)}render(){const e=`${this.props.name}-field`,t=nn()("GlueCheckbox",{"GlueCheckbox--is-disabled":this.props.isDisabled});return(0,St.jsxs)("div",{className:t,children:[(0,St.jsx)("input",{className:"GlueCheckbox__input",id:e,name:this.props.name,checked:this.props.isChecked,type:"checkbox",onChange:this.handleChange,disabled:this.props.isDisabled}),(0,St.jsx)("label",{className:"GlueCheckbox__label",htmlFor:e,dangerouslySetInnerHTML:{__html:this.props.label}})]})}}bn.defaultProps={label:"",name:"",isChecked:!1,isDisabled:!1,onChange(){}};class Sn extends bt.Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this)}handleClick(e){if(e.target.getAttribute("data-action")){"showSettings"===e.target.getAttribute("data-action")&&this.props.openSettingsPage()}}render(){const e=this.props.errorData,t=e?Lt(e.errorCategory,e.errorCode,e.errorReference):null;return t?(0,St.jsxs)("div",{className:"alert alert-danger ErrorMessage alert-icon",id:"login-message","data-ta-id":"login-message","data-testid":"login-message",role:"alert","aria-live":"assertive",onClick:this.handleClick,children:[(0,St.jsx)(Ct.l,{iconSize:24}),(0,St.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})]}):null}}const yn=(0,d.$j)((e=>{let{mode:t}=e.app;return"welcome"===t&&(t="signup"),{errorData:e[t]&&e[t].errorData?e[t].errorData:null}}),(e=>({openSettingsPage:()=>e(ft.enterSettingsMode()),openSignupPage:()=>e(ft.openSignupPage())})))(Sn);class En extends bt.PureComponent{static getNextId(){const e=(En.instanceCount||0)+1;return En.instanceCount=e,e}constructor(e){super(e),this.state={tosAgreed:!1,privacyAgreed:!1},this.handleTosChange=this.handleTosChange.bind(this),this.handlePrivacyChange=this.handlePrivacyChange.bind(this),this.handleTosAndPrivacyChange=this.handleTosAndPrivacyChange.bind(this),this.handleEulaChange=this.handleEulaChange.bind(this),this.eulaId=En.getNextId()}handleTosChange(e){this.setState({tosAgreed:e},(()=>{this.handleEulaChange()}))}handlePrivacyChange(e){this.setState({privacyAgreed:e},(()=>{this.handleEulaChange()}))}handleTosAndPrivacyChange(e){this.setState({tosAgreed:e,privacyAgreed:e},(()=>{this.handleEulaChange()}))}handleEulaChange(){this.props.onChange(this.state.tosAgreed&&this.state.privacyAgreed)}render(){let e=null;const t=`<a href="https://www.spotify.com/int/legal/end-user-agreement/" target="_new">${tt.get("desktop.login.TermsAndConditions")}</a>`,n=`<a href="https://www.spotify.com/int/legal/privacy-policy/" target="_new">${tt.get("desktop.login.PrivacyPolicy")}</a>`,s=tt.get("desktop.login.SignupButton");return e=this.props.restrictions.pretick_eula?(0,St.jsxs)("div",{children:[!this.props.hideTermsAndConditions&&(0,St.jsx)("p",{className:"SignupForm__terms-and-conditions",dangerouslySetInnerHTML:{__html:tt.get("desktop.login.SignupAgree",s,t)}}),!this.props.hidePrivacyPolicy&&(0,St.jsx)("p",{className:"SignupForm__privacy-policy",dangerouslySetInnerHTML:{__html:tt.get("desktop.login.PrivacyPolicyAgree",n)}})]}):this.props.restrictions.can_accept_licenses_in_one_step?(0,St.jsxs)("div",{className:"SignupForm__checkbox-container",children:[(0,St.jsx)(bn,{"data-ta-id":"agree-eula",name:`agree-eula-${this.eulaId}`,label:this.props.restrictions.specific_licenses?tt.get("desktop.login.SignupAgreeCheckboxSpecificLicenses",t,n):tt.get("desktop.login.SignupAgreeCheckbox",t,n),onChange:this.handleTosAndPrivacyChange,isChecked:this.state.tosAgreed&&this.state.privacyAgreed,isDisabled:this.props.disabled}),this.props.restrictions.specific_licenses&&(0,St.jsx)("p",{className:"SignupForm__privacy-policy",dangerouslySetInnerHTML:{__html:tt.get("desktop.login.PrivacyPolicyAgree",n)}})]}):(0,St.jsxs)("div",{children:[(0,St.jsx)("div",{className:"SignupForm__checkbox-container",children:(0,St.jsx)(bn,{"data-ta-id":"agree-tos",name:`agree-tos-${this.eulaId}`,label:tt.get("desktop.login.TermsOfServiceAgreeCheckbox",t),onChange:this.handleTosChange,isChecked:this.state.tosAgreed,isDisabled:this.props.disabled})}),(0,St.jsx)("div",{className:"SignupForm__checkbox-container",children:(0,St.jsx)(bn,{"data-ta-id":"agree-privacy",name:`agree-privacy-${this.eulaId}`,label:tt.get("desktop.login.PrivacyPolicyAgreeCheckbox",n),onChange:this.handlePrivacyChange,isChecked:this.state.privacyAgreed,isDisabled:this.props.disabled})})]}),(0,St.jsxs)("div",{className:"EulaAgreement",children:[e,this.props.error&&(0,St.jsx)(St.Fragment,{children:(0,St.jsx)(rn,{errorMessage:this.props.error.message})})]})}}const kn=(0,d.$j)((()=>({})),(()=>({})))(En);class wn extends bt.PureComponent{handleClick=e=>{const{method:t}=this.props;e&&(e.preventDefault(),e.stopPropagation()),this.props.onClick(t)};render(){const{type:e,label:t,isDisabled:n,method:s}=this.props,r=s.substr(0,1).toUpperCase()+s.substr(1),i=nn()("button","SocialButton",`${r}Button`,{[`${r}Button--login`]:"login"===e,[`${r}Button--signup`]:"signup"===e});return(0,St.jsx)("button",{type:"button",className:i,onClick:this.handleClick,"data-ta-id":`${s}-${e}-button`,disabled:n,children:t})}}class Cn extends bt.PureComponent{static defaultProps={isDisabled:!1,hideEula:!1};constructor(e){super(e),this.state={eulaAgreed:this.props.restrictions.pretick_eula,error:{}}}handleAgreeEulaChange=e=>{const t=e?"checked":"unchecked";this.props.onInteraction("signup","click",`eula-change-${t}`),this.setState({eulaAgreed:e,error:e?{}:this.state.error})};handleOnClick=(...e)=>{(()=>this.state.eulaAgreed||this.props.restrictions.pretick_eula||this.props.hideEula)()?this.props.onClick(...e):this.setState({error:{message:tt.get("desktop.login.agreeEula.notAccepted")}})};render(){return(0,St.jsxs)("div",{className:"SignupFacebook",children:[(0,St.jsx)(wn,{method:"facebook",isDisabled:this.props.isDisabled,onClick:this.handleOnClick,type:"signup",label:tt.get("desktop.login.SignupButtonFacebookNirvana")}),this.props.restrictions.pretick_eula||this.props.hideEula?null:(0,St.jsx)(kn,{restrictions:this.props.restrictions,error:this.state.error,disabled:this.props.isDisabled,onChange:this.handleAgreeEulaChange})]})}}const xn=(0,d.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions})),(e=>({onInteraction:(t,n,s,r,i)=>e(ft.interaction(t,n,s,r,i)),onClick:t=>{const n=wt();e(ft.signupWithAccounts(t,n)),e(ft.interaction("signup","click",`create-account-${t}`,null,n))}})),((e,t)=>({...e,...t,onClick:e=>{t.onClick(e)}})))(Cn),vn=({title:e})=>(0,St.jsx)("p",{className:"FormTitleSeparator","aria-hidden":"true",children:e});vn.defaultProps={title:""};const Tn=vn;class In extends bt.PureComponent{static defaultProps={errors:{},data:{},step:0};constructor(e){super(e),this.state={isEditing:!0}}handleEmailValidate=(e,t)=>{this.props.onValidate(e,t),t||this.props.validateEmail()};handleEmailFocus=()=>{this.props.onInteraction("signup","click","input-email")};handlePasswordValidate=(e,t)=>{this.props.onValidate(e,t),t||this.props.validatePassword()};handlePasswordFocus=()=>{this.props.onInteraction("signup","click","input-password")};handleNameFocus=()=>{this.props.onInteraction("signup","click","input-name")};handleGenderOptionFocus=e=>{this.props.onInteraction("signup","click",`input-gender-${e}`)};handleInputChange=({target:{name:e,value:t}})=>{this.props.updateData({[e]:t}),this.setState({isEditing:!0})};handleBirthDateChange=e=>{this.props.updateData({birthDate:e})};handleSendEmailChange=e=>{this.props.updateData({sendEmail:e})};handleShareDataChange=e=>{this.props.updateData({shareData:e})};handleAgreeEulaChange=e=>{this.props.updateData({agreeEula:e})};handleSubmit=e=>{e&&e.preventDefault();const{step:t}=this.props,n=wt();this.props.onInteraction("signup","click",0===t?"continue":"create-account",null,n),this.setState({isEditing:!1});let s=!0;const r={0:["email","password","name"],1:["birthDate","gender","agreeEula"]};!!this.props.errors&&Object.keys(this.props.errors).filter((e=>-1!==r[t].indexOf(e))).some((e=>this.props.errors[e]&&this.props.errors[e].message))&&(s=!1);const i=e=>t=>{this.props.data[t]||(this.props.onValidate(t,{code:e}),s=!1)};switch(t){case 0:["email","password","name"].forEach(i("valueMissing"));break;case 1:{const{day:e,month:t,year:r}=this.props.data.birthDate;r||this.props.onInteraction("signup","view","show-error-empty-year",null,n),t||this.props.onInteraction("signup","view","show-error-empty-month",null,n),e||this.props.onInteraction("signup","view","show-error-empty-date",null,n);const o=pn(e,t,r,this.props.restrictions.minimum_age);o&&(this.props.onValidate("birthDate",{code:o}),s=!1),i("valueMissing")("gender"),i("notAccepted")("agreeEula")}}if(s)switch(t){case 0:this.setStep(t+1);break;case 1:this.props.signup(n)}};handleBack=()=>{const{step:e}=this.props;this.props.onInteraction("signup","click",`back-step-${e+1}`),this.props.clearAllErrors(),e<=0?this.props.enterWelcomeMode():this.setStep(e-1)};handleLogin=()=>{const e=wt();this.props.onInteraction("signup","click","open-page-login",null,e),this.props.enterLoginMode(e)};setStep=e=>{switch(e){case 0:this.props.enterSignupModeStep0();break;case 1:this.props.enterSignupModeStep1()}};renderErrorMsg(){const e=Object.keys(this.props.errors).filter((e=>this.props.errors[e]&&this.props.errors[e].message));return(0,St.jsx)("div",{className:"glue-hidden-visually",role:"alert","aria-live":this.state.isEditing?"off":"assertive",children:e.length>0?(0,St.jsxs)("div",{children:[(0,St.jsx)("p",{children:tt.get("desktop.login.email.errorMessageA11y",e.length)}),(0,St.jsx)("ul",{children:e.map((e=>(0,St.jsx)("li",{children:this.props.errors[e].message},e)))})]}):null})}renderStep0(){const{data:e,errors:t,isDisabled:n,onValidate:s}=this.props;return(0,St.jsxs)("div",{children:[(0,St.jsx)(dn,{name:"email",type:"email",label:tt.get("desktop.login.SignupEmail"),value:e.email,onChange:this.handleInputChange,isDisabled:n,error:t.email,onValidate:this.handleEmailValidate,onFocus:this.handleEmailFocus,isRequired:!0,autoFocus:!0,rightIcon:Zt.B}),(0,St.jsx)(dn,{name:"password",type:"password",label:tt.get("desktop.login.CreateAPassword"),value:e.password,onChange:this.handleInputChange,minLength:8,isRequired:!0,isDisabled:n,error:t.password,onValidate:this.handlePasswordValidate,onFocus:this.handlePasswordFocus,onTogglePasswordVisibility:e=>{this.props.onInteraction("signup","click",e?"toggle-password-visibility-show":"toggle-password-visibility-hide")}}),(0,St.jsx)(dn,{name:"name",label:tt.get("desktop.login.SignupName"),value:e.name,onChange:this.handleInputChange,isRequired:!0,isDisabled:n,error:t.name,onValidate:s,rightIcon:Qt.W,onFocus:this.handleNameFocus})]})}renderStep1(){const{data:e,errors:t,restrictions:n,isDisabled:s,onValidate:r}=this.props;let i=null;n.requires_marketing_opt_in_text?i=(0,St.jsx)("div",{className:"SignupForm__send-email-implicit",children:tt.get("desktop.login.SendEmailImplicitLabel")}):n.requires_marketing_opt_in&&(i=(0,St.jsx)("div",{className:"SignupForm__checkbox-container",children:(0,St.jsx)(bn,{name:"send-email",label:tt.get("desktop.login.SendEmailLabel"),onChange:this.handleSendEmailChange,isChecked:e.sendEmail,isDisabled:s})}));const o=[{label:tt.get("desktop.login.Female"),value:"female"},{label:tt.get("desktop.login.Male"),value:"male"}];return n.use_all_genders&&o.push({label:tt.get("desktop.login.NonBinary"),value:"neutral"}),(0,St.jsxs)("div",{children:[(0,St.jsx)(mn,{name:"birth-date",label:tt.get("desktop.login.WhatsYourSignupBirthDate"),value:e.birthDate,onChange:this.handleBirthDateChange,disabled:s,error:t.birthDate,onValidate:r,dateEndianness:n.date_endianness,minAge:n.minimum_age,autoFocus:!0,onFocus:()=>{this.props.onInteraction("signup","click","input-birth-date")}}),(0,St.jsx)(fn,{showTitle:!0,name:"gender",label:tt.get("desktop.login.WhatsYourSignupGender"),options:o,value:e.gender,onChange:this.handleInputChange,disabled:s,error:t.gender,onValidate:r,onOptionFocus:this.handleGenderOptionFocus}),i,(0,St.jsx)(kn,{restrictions:n,error:t.agreeEula,disabled:s,onChange:this.handleAgreeEulaChange})]})}render(){const{isDisabled:e,step:t}=this.props;return(0,St.jsxs)("form",{onSubmit:this.handleSubmit,className:"SignupForm",children:[this.renderErrorMsg(),(0,St.jsx)(yn,{}),0===t?this.renderStep0():"",1===t?this.renderStep1():"",(0,St.jsx)(xt.D,{type:"submit",disabled:e,id:"signup-button",onClick:this.handleSubmit,"data-ta-id":"signup-submit",fullWidth:!0,children:0===t?tt.get("desktop.login.Continue"):tt.get("desktop.login.SignupButton")}),0===t&&(0,St.jsxs)(bt.Fragment,{children:[(0,St.jsx)(Tn,{title:tt.get("desktop.login.SignupOr")}),(0,St.jsx)(xn,{})]}),(0,St.jsx)(en.o,{onClick:this.handleBack,children:tt.get("desktop.login.Back")}),0===t&&(0,St.jsx)("h3",{className:"FooterFormText",children:(0,St.jsx)("a",{className:"FooterFormText__NoUnderline",href:"#",id:"login-link",onClick:this.handleLogin,dangerouslySetInnerHTML:{__html:tt.get("desktop.login.AlreadyOnSpotifyLogin")}})})]})}}const Nn=(0,d.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions,email:e.signup.email,errors:e.signup.errors,data:e.signup.formData})),(e=>({signup:t=>e(ft.signup(t)),enterLoginMode:()=>e(ft.enterLoginMode()),enterSignupModeStep0:()=>e(ft.enterSignupModeStep0()),enterSignupModeStep1:()=>e(ft.enterSignupModeStep1()),updateData:t=>e(ft.updateSignupData(t)),validateEmail:()=>e(ft.validateField("email")),validatePassword:()=>e(ft.validateField("password")),enterWelcomeMode:()=>e(ft.enterWelcomeMode()),clearAllErrors:()=>e(ft.clearAllErrors()),onValidate:(t,n)=>{if(n){const s=n.code||n,r={birthDate:{incomplete:tt.get("desktop.login.birthDate.incomplete"),invalid:tt.get("desktop.login.birthDate.invalid")},password:{valueMissing:tt.get("desktop.login.password.valueMissing"),tooShort:tt.get("desktop.login.password.tooShort")},email:{valueMissing:tt.get("desktop.login.email.valueMissing"),typeMismatch:tt.get("desktop.login.email.typeMismatch")},name:{valueMissing:tt.get("desktop.login.name.valueMissing")},gender:{valueMissing:tt.get("desktop.login.gender.valueMissing")},agreeEula:{notAccepted:tt.get("desktop.login.agreeEula.notAccepted")}};e(ft.validateFieldFailure(t,{code:s,message:r[t]&&r[t][s]||""}))}else e(ft.validateFieldSuccess(t))},onInteraction:(t,n,s,r,i)=>e(ft.interaction(t,n,s,r,i))})))(In);class An extends bt.PureComponent{render(){const{step:e,restrictions:t}=this.props;if(!t)return(0,St.jsx)(yt,{delay:2e3});const n=0===e?tt.get("desktop.login.SignupHeroText"):tt.get("desktop.login.SignupAlmostDone");return(0,St.jsxs)("main",{className:"Signup","data-testid":"signup","aria-labelledby":"signup-form-title",id:"signup","data-ta-id":"signup-form",children:[(0,St.jsx)("h1",{className:"HeroText",id:"signup-form-title",children:n}),(0,St.jsx)(Nn,{step:e})]})}}const Pn=(0,d.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions})))(An);class Dn extends bt.PureComponent{constructor(...e){super(...e),this.handleChange=this.handleChange.bind(this)}handleChange(){this.props.isDisabled||this.props.onChange(!this.props.isActive)}render(){const{isActive:e,isDisabled:t,labelId:n,taId:s}=this.props;return(0,St.jsxs)("div",{className:nn()("GlueToggle",{"GlueToggle--is-active":e,"GlueToggle--is-disabled":t}),children:[(0,St.jsx)("input",{type:"checkbox",name:n,id:n,className:"glue-hidden-visually",onChange:this.handleChange,checked:e,disabled:t,"data-ta-id":s}),(0,St.jsx)("div",{className:"GlueToggle__toggle",onClick:this.handleChange,"aria-hidden":"true",children:(0,St.jsx)("div",{className:"GlueToggle__toggle-inner"})})]})}}Dn.defaultProps={isActive:!1,isDisabled:!1,onChange:()=>{}};class Fn extends bt.PureComponent{render(){const{name:e,label:t,checked:n,disabled:s,onChange:r}=this.props,i=`${e}-field`;return(0,St.jsxs)("div",{className:"FormToggle",children:[(0,St.jsx)("label",{htmlFor:i,"data-ta-id":"remember-me-label",children:t}),(0,St.jsx)(Dn,{labelId:i,isActive:n,onChange:r,taId:"remember-me-slider",isDisabled:s})]})}}class Mn extends bt.PureComponent{constructor(e){super(e),this.state={username:this.props.username,password:"",rememberMe:!0},["handleSubmit","handleUsernameChange","handleUsernameFocus","handlePasswordChange","handlePasswordFocus","handleRememberMeChange"].forEach((e=>{this[e]=this[e].bind(this)}))}handleUsernameChange({target:e}){this.setState({username:e.value})}handleUsernameFocus(){this.props.onInteraction("login","click","input-email")}handlePasswordChange({target:e}){this.setState({password:e.value})}handlePasswordFocus(){this.props.onInteraction("login","click","input-password")}handleRememberMeChange(){this.setState({rememberMe:!this.state.rememberMe})}handleSubmit(e){e&&e.preventDefault();const t=this.state.username.trim(),{password:n,rememberMe:s}=this.state,r=wt();this.props.onInteraction("login","click","login-email",null,r),t&&n?this.props.login({username:t,password:n,rememberMe:s},!1,r):t?n||this.props.onInteraction("login","view","show-error-empty-password",null,r):this.props.onInteraction("login","view","show-error-empty-email",null,r)}handleForgotPasswordLinkClick=()=>{this.props.onInteraction("login","click","reset-password")};render(){const{isDisabled:e}=this.props;return(0,St.jsxs)("form",{onSubmit:this.handleSubmit,children:[(0,St.jsx)("h3",{className:"glue-hidden-visually",children:tt.get("desktop.login.LoginWithEmailTitle")}),(0,St.jsx)(yn,{}),(0,St.jsx)(dn,{name:"username",label:tt.get("desktop.login.LoginUsernameOrEmail"),value:this.state.username||"",onChange:this.handleUsernameChange,onFocus:this.handleUsernameFocus,isDisabled:e,autoFocus:!0,noValidate:!0,rightIcon:Zt.B}),(0,St.jsx)(dn,{name:"password",type:"password",label:tt.get("desktop.login.LoginPassword"),value:this.state.password,onChange:this.handlePasswordChange,onFocus:this.handlePasswordFocus,isDisabled:e,noValidate:!0}),(0,St.jsx)("a",{className:"LoginForm__reset-password",href:"https://www.spotify.com/redirect/password-reset",target:"_new",onClick:this.handleForgotPasswordLinkClick,children:tt.get("desktop.login.forgotPassLink")}),(0,St.jsx)(Fn,{name:"remember-me",label:tt.get("desktop.login.RememberMeLabel"),checked:this.state.rememberMe,onChange:this.handleRememberMeChange,disabled:e}),(0,St.jsx)("button",{type:"submit",className:"button button-white LoginForm__login-button",disabled:e,id:"login-button","data-ta-id":"login-button",children:tt.get("desktop.login.LoginButton")})]})}}const On=(0,d.$j)((e=>({isDisabled:!!e.login.loginInProgress,username:e.login.username})),(e=>({login:(t,n,s)=>e(ft.login(t,n,s)),onInteraction:(t,n,s,r,i)=>e(ft.interaction(t,n,s,r,i))})))(Mn);class jn extends bt.PureComponent{componentWillUnmount(){this.props.clearErrors()}handleSignup(){const e=wt();this.props.enterSignupMode(e),this.props.onInteraction("login","click","open-page-signup",null,e)}getSignupLink(){return(0,St.jsx)("a",{className:"FooterFormText__NoUnderline",href:"#",id:"signup-link",onClick:()=>this.handleSignup(),"data-ta-id":"signup-link",dangerouslySetInnerHTML:{__html:tt.get("desktop.login.DontHaveAnAccountSignup")}})}render(){const{isDisabled:e}=this.props;return(0,St.jsxs)("main",{className:"Login","data-testid":"login","aria-labelledby":"login-form-title",id:"login","data-ta-id":"login-form",children:[(0,St.jsx)("h1",{className:"HeroText",id:"login-form-title",children:tt.get("desktop.login.LoginHeroText")}),(0,St.jsx)(On,{}),(0,St.jsx)(Tn,{title:tt.get("desktop.login.SignupOr")}),(0,St.jsx)(wn,{method:"facebook",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:tt.get("desktop.login.ContinueWithFacebook")}),(0,St.jsx)(wn,{method:"google",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:tt.get("desktop.login.ContinueWithGoogle")}),(0,St.jsx)(wn,{method:"apple",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:tt.get("desktop.login.ContinueWithApple")}),(0,St.jsx)("h3",{className:"FooterFormText",children:this.getSignupLink()})]})}}const Ln=(0,d.$j)((e=>({isDisabled:!!e.login.loginInProgress})),(e=>({enterSignupMode:t=>e(ft.enterSignupMode(t)),onInteraction:(t,n,s,r,i)=>e(ft.interaction(t,n,s,r,i)),onSocialButtonClick:t=>{const n=wt();e(ft.loginWithAccounts(t,n)),e(ft.interaction("login","click",`login-${t}`,null,n))},clearErrors:()=>e(ft.loginClearErrors())})),((e,t)=>({...e,...t,onSocialButtonClick:e=>{t.onSocialButtonClick(e)}})))(jn);class Rn extends bt.PureComponent{render(){const{operationUsed:e}=this.props,t="signup"===e?tt.get("desktop-auth.login.redirecting-to-browser-signup"):tt.get("desktop-auth.login.redirecting-to-browser-login");return(0,St.jsx)("main",{children:(0,St.jsx)("h1",{className:"HeroText __redirect",children:t})})}}const Un=(0,d.$j)((e=>({operationUsed:e.experimentWebAuthReducer.operationUsed})))(Rn);var Gn=n(2842),Bn=n.n(Gn);const Wn="zrvvPyoxE6wQNqnu0yWA",Vn="jmu6DFPvhxRl0wSfmv2O",$n=({value:e,id:t,children:n,disabled:s,onSelect:r,className:i,dir:o})=>(0,St.jsx)("span",{className:i,children:(0,St.jsx)("select",{className:nn()(Wn,{[Vn]:"Safari"===Bn().parse(window.navigator.userAgent).browser.name}),value:e?.toString(),id:t,disabled:s,onBlur:()=>{},onChange:e=>{r(e.target.value)},dir:o,children:n})});(0,n(8732).ZP)((e=>({lastFilterState:"",lastFilteredUri:"",setLastState:(t,n)=>{e({lastFilterState:t,lastFilteredUri:n})}})));const Hn=(0,bt.createContext)({setFilter:()=>{throw new Error("setFilter must be used within a FilterProvider")},filter:""});n(537);let Kn;!function(e){e.UPDATE="update"}(Kn||(Kn={}));const Yn=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"}),qn=/\p{White_Space}/u,zn=/\p{P}/u,Jn=/\p{sc=Han}/u;function Xn(e){return null!==e&&qn.test(e)}function Zn(e){return null!==e&&(e<="/"||e>=":"&&e<="@"||"\\"===e||Xn(e))}function Qn(e){return null!==e&&zn.test(e)}function es(e){return null!==e&&Jn.test(e)}class ts{constructor(e,t,n){if(t<0||n<0||t+n>e.length)throw new RangeError;this.data=e,this.offset=t,this.length=n,this.position=0}static from(e){const t=Array.from(e.normalize("NFC"));return new ts(t,0,t.length)}toString(){return this.data.slice(this.offset,this.offset+this.length).join("")}slice(e=0,t=this.length){if(e<0||t>this.length)throw new RangeError;const n=this.offset+e,s=t-e;return new ts(this.data,n,s)}nextCodePoint(){return this.position===this.length?null:this.data[this.offset+this.position++]}}function ns(e){let t;do{t=e.nextCodePoint()}while(null!==t&&Xn(t)||Qn(t));return t}function ss(e,t){let n=ns(e),s=ns(t);if(null===s)return{offset:0,length:0};const r=e.offset+e.position-1;let i=e.offset+e.position;for(;;){if(null===n&&null===s)return{offset:r,length:i-r};if(null===s)return{offset:r,length:i-r};if(null===n)return null;if(0!==Yn.compare(n,s))return null;i=e.offset+e.position,n=ns(e),s=ns(t)}}function rs(e,t){let n,s,r;do{s=e.position,n=e.nextCodePoint()}while(null!==n&&Xn(n));if(t?.segmentQuotedStrings&&function(e){return null!==e&&('"'===e||"'"===e)}(n)){const t=n;s=e.position;do{r=e.position,n=e.nextCodePoint()}while(null!==n&&n!==t);return null===n&&s===r?null:e.slice(s,r)}do{if(r=e.position,t?.segmentCJKUnifieIdeographs&&es(n))break;n=e.nextCodePoint()}while(null!==n&&!Zn(n));return null===n&&s===r?null:e.slice(s,r)}function is(e){return rs(e,{segmentQuotedStrings:!0,segmentCJKUnifieIdeographs:!1})}function os(e){return rs(e,{segmentQuotedStrings:!1,segmentCJKUnifieIdeographs:!0})}function as(e,t){const n=[];for(let s=os(e);null!==s;s=os(e)){let r=ss(s,t.slice());null===r?(r=ss(e.slice(s.offset),t.slice()),null===r||n.push(r)):n.push(r)}return n}function ls(e,t){return e.offset===t.offset&&e.length===t.length}const ds=(e,t)=>"string"==typeof e&&"string"==typeof t?!(e.length>0)||null!==function(e,...t){const n=ts.from(e),s=[];for(let e=is(n);null!==e;e=is(n)){const n=[];for(let s=0;s<t.length;++s){const r=t[s],i=as(ts.from(r),e);for(const e of i)n.push({text:r,range:e})}if(0===n.length)return null;s.push(...n.filter(((e,t,n)=>e.range.length>0&&n.findIndex((t=>ls(e.range,t.range)))===t)))}return s.length>0?s:null}(e,t):"boolean"!=typeof e||e,cs=(0,bt.createContext)(void 0),us=({children:e})=>{const[t,n]=(0,bt.useState)(!1),[s,r]=(0,bt.useState)(new Set),i=(0,bt.useCallback)(((e,t)=>{r((n=>{if(n.has(e)===t)return n;const s=new Set(n);return t?s.add(e):s.delete(e),s}))}),[]),o=s.size>0;return(0,St.jsx)(cs.Provider,{value:{sectionMatch:t,setSectionMatch:n,sectionContainsMatch:o,setSectionFilterMatchQueryValue:i},children:e})},ps="c6TyNYOUJRIsjYZJZofy";function gs({children:e,filterMatchQuery:t}){const{filter:n}=(0,bt.useContext)(Hn),{setSectionMatch:s,sectionContainsMatch:r}=(()=>{const e=(0,bt.useContext)(cs);if(void 0===e)throw new Error("useSectionMatchState() must be used within a SectionFilterMatchContextProvider");return e})(),i=ds(n,t);return(0,bt.useEffect)((()=>{s(i)}),[i,s]),i||r?(0,St.jsx)("div",{className:ps,children:e}):null}function hs(e){return(0,St.jsx)(us,{children:(0,St.jsx)(gs,{...e})})}var ms=n(7631),_s=n.n(ms);const fs="M0E2Al6URHV3iyoDbvi_";function bs({searchWords:e,textToHighlight:t,...n}){return 0===e.length||e.every((e=>!e))?(0,St.jsx)(St.Fragment,{children:t}):(0,St.jsx)(_s(),{highlightClassName:fs,searchWords:e,textToHighlight:t,autoEscape:!0,...n})}function Ss({children:e}){const{filter:t}=(0,bt.useContext)(Hn);return(0,St.jsx)(It.D,{as:"h2",variant:"cello",semanticColor:"textBase",children:(0,St.jsx)(bs,{searchWords:[t],textToHighlight:e})})}var ys=n(5762);const Es="gvcgOXnAiNKEe_z92_lw";function ks({onClick:e}){return(0,St.jsx)(ys.P,{className:Es,onClick:e,children:tt.get("settings.restartApp")})}var ws=n(3714);const Cs="mpdBa62OP4Fr5wvCsa89",xs="acVhMt5pELcXQyLaaPuV",vs="AavUTirpKSAHapguSAy0",Ts="SkbGMKYv49KtJNB5XxdX",Is="qfjicQPaTTPrLWJWRxMQ",Ns=({id:e,type:t,placeHolder:n,inputRef:s,handleOnChange:r})=>(0,St.jsx)("input",{type:t||"text",id:e,"data-testid":e,className:Ts,placeholder:n,ref:s,onChange:r}),As=({children:e,label:t})=>(0,St.jsx)(ws.c,{label:t,className:Is,children:e}),Ps=(e,t,n)=>{let s=`${e}:${t}`;switch(n){case nt:s+="@http";break;case st:s+="@socks4";break;case rt:s+="@socks5"}return s},Ds=({addr:e,mode:t,pass:n,user:s,setValue:r,restartContainer:i,fullWidth:o})=>{const a=(0,bt.useRef)(null),l=(0,bt.useRef)(null),d=(0,bt.useRef)(null),c=(0,bt.useRef)(null),[u,p]=(0,bt.useState)(""),[g,h]=(0,bt.useState)(""),[m,_]=(0,bt.useState)(!1);(0,bt.useEffect)((()=>{const[t,n]=e?.split(/[:@]+/)||["",""];p(t),h(n),a.current&&(a.current.value=t),l.current&&(l.current.value=n)}),[e]),(0,bt.useEffect)((()=>{c.current&&n&&(c.current.value=n.toString())}),[n]),(0,bt.useEffect)((()=>{d.current&&s&&(d.current.value=s.toString())}),[s]);const f=(0,bt.useCallback)((({target:e})=>{const n=Ps(e.value,g,t||0);p(e.value),r("network.proxy.addr",n),_(!0)}),[t,g,r]),b=(0,bt.useCallback)((({target:e})=>{const n=Ps(u,e.value,t||0);h(e.value),r("network.proxy.addr",n),_(!0)}),[t,u,r]),S=(0,bt.useCallback)((({target:e})=>{r("network.proxy.user",e.value),_(!0)}),[r]),y=(0,bt.useCallback)((({target:e})=>{r("network.proxy.pass",e.value),_(!0)}),[r]),E=0!==t&&1!==t,k=t!==st;return(0,St.jsxs)(hs,{filterMatchQuery:tt.get("desktop.settings.proxy.title"),children:[(0,St.jsx)(Ss,{children:tt.get("desktop.settings.proxy.title")}),(0,St.jsxs)("div",{className:nn()(xs,o?vs:null),children:[(0,St.jsx)(As,{label:tt.get("desktop.settings.proxy.type"),children:(0,St.jsx)($n,{id:"network.proxy.mode",value:t,onSelect:e=>{const t=parseInt(e,10);r("network.proxy.mode",t),_(!0)},children:ot.map((({enumKey:e,enumValue:t})=>(0,St.jsx)("option",{value:t,"data-testid":e,children:it[e]?it[e].label():""},e)))})}),E?(0,St.jsxs)(St.Fragment,{children:[(0,St.jsxs)("div",{className:Cs,children:[(0,St.jsx)(As,{label:tt.get("desktop.settings.proxy.host"),children:(0,St.jsx)(Ns,{id:"network.proxy.host",handleOnChange:f,placeHolder:tt.get("desktop.settings.proxy.host"),inputRef:a})}),(0,St.jsx)(As,{label:tt.get("desktop.settings.proxy.port"),children:(0,St.jsx)(Ns,{id:"network.proxy.port",type:"number",handleOnChange:b,placeHolder:tt.get("desktop.settings.proxy.port"),inputRef:l})})]}),(0,St.jsxs)("div",{className:k?Cs:void 0,children:[(0,St.jsx)(As,{label:tt.get("desktop.settings.proxy.user"),children:(0,St.jsx)(Ns,{id:"network.proxy.user",handleOnChange:S,placeHolder:tt.get("desktop.settings.proxy.user"),inputRef:d})}),k?(0,St.jsx)(As,{label:tt.get("desktop.settings.proxy.pass"),children:(0,St.jsx)(Ns,{id:"network.proxy.pass",handleOnChange:y,placeHolder:tt.get("desktop.settings.proxy.pass"),type:"password",inputRef:c})}):null]})]}):null,m&&(0,St.jsx)("div",{children:(0,St.jsx)(ks,{onClick:i})})]})]})},Fs=["network.proxy.mode","network.proxy.addr","network.proxy.user","network.proxy.pass"];const Ms=(0,d.$j)((e=>({settings:{proxy:e.settings.proxy}})),(e=>({fetchProxySettings(){e(ft.fetchProxySettings())},updateProxySettings(t){e(ft.updateProxySettings(t))},restartClient(){e(ft.restartClient())}})))((({settings:e={proxy:{mode:0,address:"",username:"",password:""}},fetchProxySettings:t=(()=>{}),updateProxySettings:n=(()=>{}),restartClient:s=(()=>{})})=>{(0,bt.useEffect)((()=>{t()}),[t]);const r=(0,bt.useCallback)(((t,s)=>{if(function(e){return!!Fs.includes(e)}(t)){const r={...e.proxy};switch(t){case"network.proxy.mode":r.mode=s;break;case"network.proxy.addr":r.address=s;break;case"network.proxy.user":r.username=s;break;case"network.proxy.pass":r.password=s}n(r)}return Promise.resolve()}),[e,n]);return(0,St.jsxs)("main",{className:"Settings","aria-labelledby":"settings-form-title","data-testid":"settings",children:[(0,St.jsx)("h1",{className:"HeroText",id:"settings-form-title",children:tt.get("desktop.login.PreferencesLink")}),(0,St.jsx)(Ds,{mode:e.proxy.mode,addr:e.proxy.address,user:e.proxy.username,pass:e.proxy.password,setValue:r,restartContainer:s,fullWidth:!0})]})}));class Os extends bt.PureComponent{constructor(e){super(e),this.handleSettingsClick=this.goToSettingsPage.bind(this),this.handleBackToLoginClick=this.handleBackToLoginClick.bind(this)}handleSignupClick(){const{openSignupPage:e,onInteraction:t}=this.props,n=wt();e(n),t("login/welcome","click","open-page-signup",null,n)}handleBackToLoginClick(e){e.preventDefault(),this.props.openLoginPage(),this.props.onInteraction(this.props.mode,"click","back-to-login")}goToSettingsPage(e){e.preventDefault(),this.props.openSettingsPage(),this.props.onInteraction(this.props.mode,"click","open-page-settings")}renderPreferencesLink(){return(0,St.jsx)("a",{className:"Footer__link",href:"#",onClick:this.handleSettingsClick,"data-ta-id":"login-footer-settings",children:tt.get("desktop.login.PreferencesLink")})}renderBackToLoginLink(){return(0,St.jsx)("a",{className:"Footer__link",href:"#",onClick:this.handleBackToLoginClick,"data-ta-id":"login-footer-settings-back-to-login",children:tt.get("desktop.login.Back")})}renderTryAgain(){return(0,St.jsxs)(St.Fragment,{children:[(0,St.jsx)("span",{children:tt.get("desktop-auth.login.not-seeing-browser")})," ",(0,St.jsx)("a",{href:"#",onClick:()=>this.props.tryAgainHandler(),children:tt.get("desktop-auth.login.try-again")})]})}renderSignupLink(){return(0,St.jsx)("a",{className:"Footer__NoUnderline",href:"#",id:"signup-link",onClick:()=>this.handleSignupClick(),"data-ta-id":"welcome-signup-link",dangerouslySetInnerHTML:{__html:tt.get("desktop.login.DontHaveAnAccountSignup")}})}renderRussiaLegalFormLink(){return(0,St.jsx)("div",{children:(0,St.jsx)("a",{className:"Footer__link",href:"https://support.spotify.com/ru-ru/contact-spotify-legal-form/",target:"_blank",rel:"noopener",children:"Форма для Ваших обращений"})})}renderMode(e,t){return"login"===e||"welcome"===e&&t?this.renderPreferencesLink():"settings"===e?this.renderBackToLoginLink():"open-browser"===e?this.renderTryAgain():"welcome"===e?this.renderSignupLink():null}render(){const{mode:e,country:t,isAuthOnWebEnabled:n}=this.props;return(0,St.jsxs)("footer",{className:"Footer",role:"contentinfo",children:[this.renderMode(e,n),"RU"===t&&this.renderRussiaLegalFormLink()]})}}const js=(0,d.$j)((e=>({country:e.signup.restrictions?.country})),(e=>({tryAgainHandler:()=>{e(ft.abortLoginWithAccounts()),e(ft.enterWelcomeMode())},openLoginPage:()=>{e(ft.enterLoginMode())},openSignupPage:t=>e(ft.enterSignupMode(t)),openSettingsPage:()=>e(ft.enterSettingsMode()),onInteraction:(t,n,s,r,i)=>e(ft.interaction(t,n,s,r,i))})))(Os);class Ls extends bt.PureComponent{render(){return(0,St.jsxs)("header",{className:"Header",children:[(0,St.jsx)("h1",{className:"glue-hidden-visually",children:"Spotify"}),(0,St.jsx)("img",{className:"Header__logo",src:"images/logo.svg",alt:""})]})}}var Rs=n(1141),Us=n(5879),Gs=n(5947);const Bs=(0,n(7486).JP)({name:"enableAuthOnWeb",description:"Property to enable experiment to use web authentication for Desktop application.",default:!1});class Ws extends bt.Component{static defaultProps={throbberDelay:0,transitionLeaveTimeout:0};renderFakeWebPlayer(){return(0,St.jsxs)("div",{className:"fakeWebPlayer",children:[(0,St.jsx)("aside",{}),(0,St.jsxs)("footer",{children:[(0,St.jsx)("div",{className:"fakeWebPlayer__footer-left"}),(0,St.jsx)("div",{className:"fakeWebPlayer__footer-center"}),(0,St.jsx)("div",{className:"fakeWebPlayer__footer-right"})]}),(0,St.jsx)("main",{children:(0,St.jsx)("div",{className:"fakeWebPlayer__content"})})]})}renderMode(e,t,n,s){return"settings"===e?(0,St.jsx)(Ms,{}):n?(0,St.jsx)(Xt,{eventSender:s}):"welcome"===e?(0,St.jsx)(Tt,{}):"signup"===e?(0,St.jsx)(Pn,{step:t}):"login"===e?(0,St.jsx)(Ln,{}):"open-browser"===e?(0,St.jsx)(Un,{}):null}render(){const{loading:e,mode:t,loggedIn:n,previousMode:s,throbberDelay:r,signupStep:i,previousSignupStep:o,isAuthOnWebEnabled:a,eventSender:l}=this.props;if(e||!t)return(0,St.jsx)(yt,{delay:r});if(n)return null;let d=s?`__${t} __${s}-to-${t}`:"";return"signup"===t&&Number.isInteger(o)&&(d+=` __signup_step_${o}_to_${i}`),(0,St.jsxs)("main",{className:"App","data-ta-id":"login-app","data-testid":"login-app","data-ta-login-mode":t,children:[this.renderFakeWebPlayer(),(0,St.jsx)("div",{className:`App__content ${d}`,children:(0,St.jsx)(Us.Z,{mode:"in-out",children:(0,St.jsx)(Rs.Z,{timeout:{appear:0,enter:0,exit:650},children:(0,St.jsxs)("div",{className:`App__modal ${d}`,children:[(0,St.jsx)(Ls,{}),this.renderMode(t,i,a,l),(0,St.jsx)(js,{mode:t,isAuthOnWebEnabled:a})]})},d)})})]},"main1")}}const Vs=(0,Gs.yS)({isAuthOnWebEnabled:Bs}),$s=(0,d.$j)((e=>({mode:e.app.mode,previousMode:e.app.previousMode,signupStep:e.signup.step,previousSignupStep:e.signup.previousStep,loading:!!e.login.loading,loggedIn:!!e.login.loggedIn,throbberDelay:e.login.throbberDelay,transitionLeaveTimeout:e.login.redirectDelay})))(Vs(Ws));var Hs=n(762),Ks=n(1958);const Ys=e=>t=>n=>{const s=t(n);switch(n.type){case ft.START_APP:e.dispatch(ft.getSignupRestrictions());!g.getItem("lastUsername")?e.dispatch(ft.enterWelcomeMode()):e.dispatch(ft.enterLoginMode());break;case ft.LOGIN_FAIL:{const t=e.getState();if(n.loginType===ft.LOGIN_TYPE_AUTOLOGIN){const n=t.app.mode;"welcome"===n?e.dispatch(ft.enterWelcomeMode()):"login"===n?e.dispatch(ft.enterLoginMode()):"signup"===n&&e.dispatch(ft.enterSignupMode())}else{if("open-browser"===t.app.mode){const s=n.errorData;let r=Lt(s.errorCategory,s.errorCode,s.errorReference);"desktop_login_accounts"===s.errorCategory&&4===s.errorCode&&(r="signup"===t.experimentWebAuthReducer.operationUsed?tt.get("desktop-auth.login.signup-time-out"):tt.get("desktop-auth.login.login-time-out")),r?e.dispatch(ft.enterWelcomeMode(r)):e.dispatch(ft.enterWelcomeMode())}}break}case ft.ENTER_SIGNUP_MODE:{const t=e.getState().signup.restrictions;t?!1===t.is_country_launched&&e.dispatch(ft.countryNotLaunched()):e.dispatch(ft.getSignupRestrictions());break}case ft.SIGNUP_RESTRICTIONS_SUCCESS:!1===n.restrictions.is_country_launched&&e.dispatch(ft.countryNotLaunched());break;case ft.SIGNUP_FAILURE:(n.errors.email||n.errors.password||n.errors.displayname)&&e.dispatch(ft.enterSignupModeStep0());break;case ft.COUNTRY_NOT_LAUNCHED:e.dispatch(ft.openSignupPage(!0))}return s},qs=e=>{window.location.href=e},zs=()=>e=>t=>{const n=e(t);if(!t.redirectTo)return n;let s;return"xpui"!==t.redirectTo||(s="spotify:app:xpui",t.redirectDelay?setTimeout((()=>{qs(s)}),t.redirectDelay):qs(s)),n},Js={errorMessage:null};const Xs=function(e=Js,t){switch(t.type){case ft.ENTER_SIGNUP_MODE:return{...e,previousMode:e.mode,mode:"signup"};case ft.ENTER_LOGIN_MODE:case ft.COUNTRY_NOT_LAUNCHED:return{...e,previousMode:e.mode,mode:"login"};case ft.ENTER_WELCOME_MODE:return{...e,previousMode:e.mode,mode:"welcome",errorMessage:t.errorMessage??null};case ft.ENTER_SETTINGS_MODE:return{...e,previousMode:e.mode,mode:"settings"};default:return e}};const Zs={proxy:{mode:0,address:"",username:"",password:""}};const Qs=function(e=Zs,t){return function(e){return e.type===ft.SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS}(t)?{...e,proxy:{mode:t.data.mode,address:t.data.address,username:t.data.username,password:t.data.password}}:e},er={step:0,isAttempting:!1,isSuccessful:void 0,errors:{},errorData:{},validated:{},formData:{name:"",email:"",password:"",birthDate:{day:void 0,month:void 0,year:void 0},gender:void 0,sendEmail:void 0,shareData:void 0,agreeEula:!1},restrictions:void 0};const tr=function(e=er,t){switch(t.type){case ft.ENTER_SIGNUP_MODE_STEP_0:return{...e,previousStep:e.step,step:0};case ft.ENTER_SIGNUP_MODE_STEP_1:return{...e,previousStep:e.step,step:1};case ft.SIGNUP_RESTRICTIONS_SUCCESS:return{...e,formData:{...e.formData,sendEmail:!!t.restrictions.requires_marketing_opt_in_text||void 0,agreeEula:!!t.restrictions.pretick_eula},restrictions:t.restrictions};case ft.SIGNUP_RESTRICTIONS_FAILURE:return{...e,errorData:t.error};case ft.SIGNUP_ATTEMPT:return{...e,isAttempting:!0,errorData:null};case ft.SIGNUP_SUCCESS:return{...e,isAttempting:!0,isSuccessful:!0,errorData:null};case ft.SIGNUP_FAILURE:return{...e,isAttempting:!1,isSuccessful:!1,errors:t.errors,errorData:null};case ft.FACEBOOK_SIGNUP_ATTEMPT:return{...e,errorData:null,errors:{}};case ft.FACEBOOK_SIGNUP_FAILURE:return{...e,errorData:t.errorData};case ft.VALIDATE_FIELD_ATTEMPT:return{...e,errors:{...e.errors,[t.field]:void 0}};case ft.VALIDATE_FIELD_FAILURE:return{...e,errors:{...e.errors,[t.field]:t.error},validated:{...e.validated,[t.field]:!1}};case ft.VALIDATE_FIELD_SUCCESS:return{...e,errors:{...e.errors,[t.field]:void 0},validated:{...e.validated,[t.field]:!0}};case ft.UPDATE_SIGNUP_DATA:{const n={};for(const e of Object.keys(t.data))n[e]=void 0;return{...e,errors:{...e.errors,...n},formData:{...e.formData,...t.data}}}case ft.CLEAR_ALL_ERRORS:return{...e,errors:{}};default:return e}};function nr(e){const t=(0,Hs.MT)((0,Hs.UY)({app:Xs,login:y,settings:Qs,signup:tr}),void 0,(0,Hs.md)(Ks.Z,Ys,(e=>{const t=new zt(e);return()=>e=>n=>{const s=e(n);switch(n.type){case ft.ENTER_LOGIN_MODE:t.logPageView({page:"login"});break;case ft.LOGIN_SUCCESS:n.loginType===ft.LOGIN_TYPE_EMAIL&&t.logAction({page:"login",action_type:"view",action_intent:"show-success-login-email"});break;case ft.LOGIN_FAIL:n.loginType===ft.LOGIN_TYPE_EMAIL&&n.errorData&&3===n.errorData.errorCode&&t.logAction({page:"login",action_type:"view",action_intent:"show-error-invalid-credential"});break;case ft.ENTER_SIGNUP_MODE:t.logPageView({page:"signup"});break;case ft.ENTER_SIGNUP_MODE_STEP_0:t.logAction({page:"signup",action_type:"view",action_intent:"show-signup-step-one"});break;case ft.ENTER_SIGNUP_MODE_STEP_1:t.logAction({page:"signup",action_type:"view",action_intent:"show-signup-step-two"});break;case ft.SIGNUP_SUCCESS:t.logAction({page:"signup",action_type:"view",action_intent:"show-success-signup-email"});break;case ft.SIGNUP_FAILURE:t.logAction({page:"signup",action_type:"view",action_intent:"show-error-signup-email",item_id:n.errors&&Object.keys(n.errors).join("|")});break;case ft.FACEBOOK_SIGNUP_SUCCESS:t.logAction({page:"signup",action_type:"view",action_intent:"show-success-authentication-facebook"});break;case ft.FACEBOOK_SIGNUP_FAILURE:t.logAction({page:"signup",action_type:"view",action_intent:"show-error-authentication-facebook",item_id:n.errorData&&`${n.errorData.errorCode} - ${n.errorData.errorDescription}`});break;case ft.ENTER_WELCOME_MODE:t.logPageView({page:"login/welcome"});break;case ft.ENTER_SETTINGS_MODE:t.logPageView({page:"login/settings"});break;case ft.INTERACTION:t.logAction({page:n.page,action_type:n.interactionType,action_intent:n.intent,item_id:n.itemId,action_hash:n.actionHash});break;case ft.VALIDATE_FIELD_FAILURE:if(n.error){const e=n.field,s=n.error.code;let r=null,i=null;"valueMissing"===s?r=`show-error-empty-${e}`:["incomplete","invalid","typeMismatch","tooShort"].includes(s)?r=`show-error-format-${e}`:(r=`show-error-${e}`,i=n.error.message||""),null!==r&&t.logAction({page:"signup",action_type:"view",action_intent:r,...i?{item_id:i}:{}})}}return s}})(e),zs));return t.subscribe((()=>{const e=t.getState();e.login.username&&localStorage.setItem(h,e.login.username),e.login.utmParameters&&localStorage.setItem(_,JSON.stringify(e.login.utmParameters))})),t}var sr=n(2090),rr=n(4909);let ir=null;var or=n(7987),ar=n(4254);const lr=(e,t)=>{const n=e.event_sender_context_information;return[(0,ar.UY)({version_code:n.client_version_int,version_string:n.client_version_string}),(0,ar.jx)(t),(0,ar.IE)(n.installation_id),(0,ar.CF)({device_id:n.device_id,device_manufacturer:n.device_manufacturer,device_model:n.device_model,os_version:n.os_version,platform_type:n.platform_type})]};var dr=n(423);(async function(){for(const e of[window.__spotify.locale,ze.en])try{const t=await fetch(`i18n/${e}.json`).then((e=>e.json()));return tt.setLocale(e),void tt.setDictionary(t)}catch(e){0}throw new Error("Cannot find a suitable locale! Something is wrong: talk to #desktop.")})().then((async function(){const e=function(){const e=(0,rr.qy)({providers:{endpoints:(0,rr.uG)(),token:()=>null}});return e.connect(),e}();ir=e;const t=((e,t,n)=>(0,or.mi)({transport:t,suppressPersist:!1,context:lr(e,n)}))(window.__spotify,e,"65b708073fc0480ea92a077233ca87bd"),n=nr(t);u.attach(),u.update(),c.attach();const s=document.location.search,r=new RegExp(`\\?param=error-code\\${encodeURIComponent("=")}([0-9]+)`,"i");window.addEventListener("message",(e=>{"critical-update-error"===e.data&&n.dispatch(ft.loginFailed({errorCode:e.data}))}));const i=s.match(r);if(s&&i){const e=+i[1];n.dispatch(ft.loginFailed({errorCode:e}))}let o="linux";window.navigator.platform.startsWith("Mac")&&(o="mac"),window.navigator.platform.startsWith("Win")&&(o="windows"),document.body.classList.add(`body-container--${o}`),a.render((0,St.jsx)(l.zj,{children:(0,St.jsx)(d.zt,{store:n,children:(0,St.jsx)(Gs.nD,{resolver:dr.L,context:{username:null},options:{clientId:"client-desktop-ui-app-login",timeout:5e3,transport:e,eventSender:t,installationId:window.__spotify.event_sender_context_information?.installation_id},children:(0,St.jsx)(bt.Suspense,{fallback:null,children:(0,St.jsx)($s,{eventSender:t})})})})}),document.getElementById("main")),n.dispatch(ft.startApp()),document.documentElement.setAttribute("dir",window.__spotify.localization_is_rtl?"rtl":"ltr");const p={[sr.PLATFORM_UNKNOWN]:"body-container--unknown-os",[sr.PLATFORM_MAC]:"body-container--mac",[sr.PLATFORM_WINDOWS]:"body-container--windows"},g=(0,sr.getPlatform)();document.body.classList.add(p[g])}))},2090:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PLATFORM_MAC:()=>r,PLATFORM_UNKNOWN:()=>s,PLATFORM_WINDOWS:()=>i,getPlatform:()=>l,isMac:()=>o,isWindows:()=>a});const s=Symbol("PLATFORM_UNKNOWN"),r=Symbol("PLATFORM_MAC"),i=Symbol("PLATFORM_WINDOWS");function o(){return window.navigator.platform.startsWith("Mac")}function a(){return window.navigator.platform.startsWith("Win")}function l(){return o()?r:a()?i:s}},8943:(e,t)=>{let n=!1;t.update=()=>{},t.attach=()=>{if(n)return;n=!0;const e=window.__spotify&&window.__spotify.locale;e&&document.documentElement.setAttribute("lang",e)},t.detach=()=>{n&&(n=!1,document.documentElement.removeAttribute("lang"))}},3925:(e,t,n)=>{const{getPlatform:s,PLATFORM_UNKNOWN:r,PLATFORM_MAC:i,PLATFORM_WINDOWS:o}=n(2090);let a=!1,l="always-visible",d=0;const c={[r]:"linux",[i]:"mac",[o]:"windows"};let u=c[r];function p(){const e=[...document.querySelectorAll("*")],t=[],n=["scroll","auto","overlay"];e.forEach((e=>{const s=window.getComputedStyle(e),r=s.overflowX,i=s.overflowY;n.includes(r)&&t.push({node:e,property:"overflow-x"}),n.includes(i)&&t.push({node:e,property:"overflow-y"})}));const s=document.createElement("style");s.innerHTML="\n    html::-webkit-scrollbar,\n    body::-webkit-scrollbar {\n      background-color: rgba(1, 2, 3, 0) !important;\n    }\n  ".trimRight();const r=`data-scrollbar-fix-${++d}-id`;let i=0;t.forEach((({node:e,property:t})=>{if(e!==document.body){const n=++i;e.setAttribute(r,n),s.innerHTML+=`\n    [${r}="${n}"] { ${t}: hidden !important; }`}})),document.head.appendChild(s),setTimeout((()=>{document.head.removeChild(s),t.forEach((({node:e})=>{e.removeAttribute(r)}))}),0)}t.performScrollBarFix=p,t.update=function(){},t.attach=function(){if(a)return;a=!0;const e=window.__spotify&&window.__spotify.scroller_style;l="overlay"===e?"overlay":"always-visible";const t=s();u=c[t],"always-visible"===l||"mac"!==u?(document.body.classList.remove("scrollbar-style-when-scrolling-mac"),document.body.classList.add(`scrollbar-style-visible-${u}`)):(document.body.classList.remove(`scrollbar-style-visible-${u}`),document.body.classList.add("scrollbar-style-when-scrolling-mac")),window.addEventListener("message",(e=>{"set_active"===e.data.name&&e.data.active&&p()}))},t.detach=function(){a&&(a=!1,d=0)}}},n={};function s(e){var r=n[e];if(void 0!==r)return r.exports;var i=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.loaded=!0,i.exports}s.m=t,s.amdO={},e=[],s.O=(t,n,r,i)=>{if(!n){var o=1/0;for(c=0;c<e.length;c++){for(var[n,r,i]=e[c],a=!0,l=0;l<n.length;l++)(!1&i||o>=i)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(a=!1,i<o&&(o=i));if(a){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[n,r,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={535:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var r,i,[o,a,l]=n,d=0;if(o.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(l)var c=l(s)}for(t&&t(n);d<o.length;d++)i=o[d],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(c)},n=("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0;var r=s.O(void 0,[569],(()=>s(9430)));r=s.O(r)})();
//# sourceMappingURL=login.js.map