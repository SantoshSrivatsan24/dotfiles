"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[8059,8396],{87581:(e,s,o)=>{o.d(s,{Q:()=>d});var n=o(87462),t=o(67294),r=o(94184),i=o.n(r);const a="_pMNGOs2KBLWGpGmunYI";function d(e){return t.createElement("section",(0,n.Z)({},e,{className:i()(a,e.className)}))}},14784:(e,s,o)=>{o.r(s),o.d(s,{ALL_EPISODE_SPONSORS_TESTID:()=>f,AllEpisodeSponsors:()=>E,allEpisodeSponsorsPath:()=>l.e,default:()=>S});var n=o(87462),t=o(67294),r=o(51615),i=o(72125),a=o(28975),d=o(87581),p=o(77186);var c=o(88396),u=o(99922),l=o(61737);const f="all-episode-sponsors";function E({EpisodeSponsorsWrapper:e=c.EpisodeSponsorsWrapper}){const{[a.hd]:s}=(0,r.UO)(),o=(0,p.P)(),l=(0,u.o)();return o.location.state?t.createElement(d.Q,{"data-testid":f},t.createElement(e,(0,n.Z)({},l,{numberOfSponsorsToDisplay:1/0,reason:"Episode page See All"}))):t.createElement(i.A,{to:(0,a.lc)(s)})}const S=E},88396:(e,s,o)=>{o.r(s),o.d(s,{EPISODE_SPONSORS_SHELF_TESTID:()=>m,EpisodeSponsorsWrapper:()=>D,SEE_ALL_EPISODE_SPONSORS_TESTID:()=>v,default:()=>h});var n=o(87462),t=o(67294),r=o(1486),i=o(8271);const a=(0,t.lazy)((()=>Promise.all([o.e(1814),o.e(7258)]).then(o.bind(o,87258))));function d({fetchedEpisodeSponsorsData:e,fireTrackingEvent:s,numberOfSponsorsToDisplay:o,firedViewedEvents:d,version:p,reason:c,uri:u}){const{displayedEpisodeSponsorsData:l}=function({fetchedEpisodeSponsorsData:e,numberOfSponsorsToDisplay:s}){return(0,t.useMemo)((()=>({displayedEpisodeSponsorsData:e.slice(0,s)})),[e,s])}({fetchedEpisodeSponsorsData:e,numberOfSponsorsToDisplay:o}),f=(0,i.s4)(),E=(0,t.useMemo)((()=>l.map(((e,o)=>t.createElement(a,(0,n.Z)({key:`${e.metadata.lineitem_id}-${o}`,fireTrackingEvent:s,firedViewedEvents:d,version:p,onClick:async function(){return f.send((0,r.$)({uri:u,reason:c,lineitem_id:l.map((e=>e.metadata.lineitemId)),ui_navigate:l.map((({clickthrough:e},s)=>o===s?e:"")),navigate_to_external_uri:l.map(((e,s)=>o===s))}))}},e))))),[l,s,d,p,c,u,f]);return{displayedEpisodeSponsorsData:l,displayedSponsors:E}}var p=o(69518),c=o.n(p);var u=o(51615);var l=o(18693);function f({firedViewedEvents:e}){const s=(0,t.useRef)();return{firedViewedEvents:s.current=e??s.current??new Set}}function E({uri:e,getEpisodeSponsors:s,fireTrackingEvent:o,numberOfSponsorsToDisplay:n,version:r,reason:i}){const{state:a}=(0,u.TH)(),{episodeBase62Id:p}=function({uri:e,episodeBase62Id:s}){return{episodeBase62Id:(0,t.useMemo)((()=>s||c().from(e)?.getBase62Id()),[e,s])}}({...a,uri:e}),{fetchedEpisodeSponsorsData:E}=(0,l.m)({...a,episodeBase62Id:p,getEpisodeSponsors:s,version:r}),{firedViewedEvents:S}=f({...a});return{uri:e,episodeBase62Id:p,fetchedEpisodeSponsorsData:E,...d({fetchedEpisodeSponsorsData:E,fireTrackingEvent:o,numberOfSponsorsToDisplay:n,firedViewedEvents:S,version:r,reason:i,uri:e}),firedViewedEvents:S,reason:i}}const S=(0,t.lazy)((()=>o.e(7479).then(o.bind(o,27479)))),m="episode-sponsors-shelf",v="see-all-episode-sponsors";function D(e){const{numberOfSponsorsToDisplay:s}=function({numberOfSponsorsToDisplay:e=3}){return{numberOfSponsorsToDisplay:e}}(e),o=E({...e,numberOfSponsorsToDisplay:s});return o.episodeBase62Id&&o.displayedSponsors.length?t.createElement(t.Suspense,{fallback:!0},t.createElement(S,(0,n.Z)({},e,{numberOfSponsorsToDisplay:s,state:o}))):null}const h=D},18693:(e,s,o)=>{o.d(s,{F:()=>i,m:()=>a});var n=o(67294),t=o(64005),r=o(31604);const i=420;function a({episodeBase62Id:e,getEpisodeSponsors:s,fetchedEpisodeSponsorsData:a=[],version:d}){const[p,c]=(0,n.useState)(a),u=(0,n.useCallback)((async()=>{try{if(!e)throw new Error("episodeBase62Id is required to fetch episode sponsors");const n=s??(await Promise.resolve().then(o.bind(o,11401))).getEpisodeSponsors;c(await n(e,{version:d}))}catch(e){c([])}}),[e,s,d]),l=(0,t.y)(u,i);return(0,n.useEffect)((function(){a.length||l()}),[l,a.length]),(0,r.H)(l),{fetchedEpisodeSponsorsData:p}}},99922:(e,s,o)=>{o.d(s,{o:()=>r});var n=o(87577),t=o(49207);function r(){return{version:(0,n.W6)(t.GE)?2:1}}},31604:(e,s,o)=>{o.d(s,{H:()=>p});var n=o(67294),t=o(87577),r=o(49207),i=o(40080),a=o(8341),d=o(89952);function p(e){const s=(0,t.W6)(r.oF),o=(0,a.Y)((e=>{const s=e?.item??void 0;return(0,d.k6)(s)&&s.isPodcastAd?s.id??void 0:void 0})),p=(0,i.D)(o);(0,n.useEffect)((function(){o!==p&&Boolean(o)&&setTimeout(e,s)}),[e,o,p,s])}},77186:(e,s,o)=>{o.d(s,{P:()=>r});var n=o(67294),t=o(51615);function r(){const e=(0,t.k6)(),{listen:s,location:o}=e;return(0,n.useEffect)((function(){return s(((e,s)=>{"POP"===s&&(e.state={...o.state,...e.state})}))})),e}},40080:(e,s,o)=>{o.d(s,{D:()=>t});var n=o(67294);function t(e){const s=(0,n.useRef)();return(0,n.useEffect)((()=>{s.current=e}),[e]),s.current}}}]);
//# sourceMappingURL=xpui-routes-all-episode-sponsors.js.map