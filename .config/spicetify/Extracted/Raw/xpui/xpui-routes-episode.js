"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[472],{99922:(e,t,a)=>{a.d(t,{o:()=>l});var n=a(44794),i=a(44503);function l(){return{version:(0,n.W6)(i.GE)?2:1}}},50977:(e,t,a)=>{a.r(t),a.d(t,{Episode:()=>$e,default:()=>Ve,parseReleaseDate:()=>Ye});var n=a(67294),i=a.n(n),l=a(65858),r=a(16528),s=a(69518),o=a.n(s),d=a(96685),c=a(44794),m=a(44503),u=a(62890);const p="Ck11dU0ipD52SdUcCdl3",k="EzPp2M6sPnJCpwd8Jbi7",v="WL5zy4E6QItBeCT6BdYq",g="HXLKjt4pA15hJqLJxnWA",E="FdpyBxDdNrrL27wrINsy",y="QJPX1kGtuCNg6EUL2LAS",b="ltjunXlP2FwPEVF992n9",h="PFsc4aA7WK6jCXfONJal",S="C_bheWFgPaQZ3AA2SgG5",P=({cardHeaderText:e,cardBodyText:t,buttonText:a,buttonTarget:n})=>(0,c.W6)(m.Xd)?i().createElement("div",{className:b},i().createElement("div",{className:h},i().createElement(d.LF,{variant:"balladBold",semanticColor:"textBase"},e),i().createElement(d.LF,{variant:"viola",semanticColor:"textBase"},t)),i().createElement(u.z,{version:"primary",linkTo:o().from(n).toURLPath(!0),className:S},a)):null;var N=a(20657),f=a(30947),U=a(11414),C=a(20246),x=a(18261),w=a(20238),T=a(62975),F=a(57978),I=a(34325),A=a(43620),L=a(23716),D=a(84242),M=a(52759),R=a(8341),B=a(52404),_=a(86649),z=a(7073),W=a(92408),O=a(84788),K=a(84629),X=a(67154),Z=a.n(X),$=a(99922),V=a(74849);const Y=(0,n.lazy)((()=>a.e(396).then(a.bind(a,88396))));function G(e){const t=(0,V.m)(),a=(0,$.o)();return t?i().createElement(n.Suspense,{fallback:!0},i().createElement(Y,Z()({reason:"Episode page"},a,e))):null}var J=a(1663),Q=a(95661),q=a(22345),H=a(42273),j=a(59482),ee=a(72907),te=a(55911),ae=a(46245),ne=a(18061),ie=a(8247),le=a(72917),re=a(95806);const se="activation-trigger-mme",oe=({episodeUri:e,showUri:t,isLocked:a,isPlaying:n,isPlayDisabled:r,playButtonPlayLabel:s,playButtonPauseLabel:d,onClick:c})=>{const m=(0,l.v9)((e=>{var t;return null===(t=e.platform)||void 0===t?void 0:t.isBrowser})),u=i().createElement(ne.F,{property:ie.iY,renderOldExperience:()=>i().createElement(re.l,{showUri:t,enabled:a,renderInline:!1},i().createElement(te.JM,{size:te.qE.lg,onClick:c,isPlaying:n,disabled:r,locked:a,ariaPlayLabel:s,ariaPauseLabel:d})),renderNewExperience:()=>i().createElement(re.l,{showUri:t,enabled:a,renderInline:!1},i().createElement(ae.fh,{size:"lg",onClick:c,isPlaying:n,disabled:r,locked:a,ariaPlayLabel:s,ariaPauseLabel:d}))});return m?i().createElement(le.c,{id:se,targetURI:o().from(e)},u):u};var de=a(67892),ce=a(32626),me=a(5944),ue=a(60410),pe=a(31610);const ke="UVWRbDQd2DM0ShkvMq54",ve="Eoy1M3AAKeAUI9cNWsuq",ge="rmgkmccGmTBvrw7gXMyS",Ee="JKIiOrx9EhZCkyBsu7YI";function ye(e){return(null==e?void 0:e.replace(/T.*/,""))||""}function be(e){const t=o().from(e);return`/show/${o().hexToId((null==t?void 0:t.id)||"")}`}const he=i().memo((({chapter:e})=>{var t;const{name:a,uri:r,playedState:s,contentRating:o,duration:d,releaseDate:c,playability:m}=e,p=e.book,k=e.coverArt.length?e.coverArt:p.coverArt||[],v=null===(t=k[0])||void 0===t?void 0:t.url,g=(0,A.Z)(v||null),E=(0,l.I0)(),[y,b]=(0,n.useState)(s.state===z.sY.Completed),{triggerPlay:h,togglePlay:S,isPlaying:P,isActive:U}=(0,D.n)({uri:r},{featureIdentifier:"episode"}),C=(0,R.Y)((e=>{var t;return null!==(t=(0,me.k)(e))&&void 0!==t?t:void 0})),w=(0,ue.S)(e),{badges:T}=(0,O.r)({contentRating:null==o?void 0:o.label}),I=(0,n.useCallback)((e=>{!m.playable&&T.nineteen&&(e.stopPropagation(),E((0,K.RM)(r||"")))}),[r,m.playable,T.nineteen,E]),L=(0,n.useCallback)((e=>{w||(U?S():h({seekTo:e}))}),[w,U,S,h]);(0,n.useEffect)((()=>{const e=new URLSearchParams(location.search);if(e.has("t")){const t=e.get("t")||"0",a=1e3*parseInt(t,10);a<=d.milliseconds&&L(a)}}),[d,L]);const M=!w&&!m.playable,B=p.uri,_=p.name,X=N.ag.get("tracklist.a11y.play",a,_),Z=N.ag.get("tracklist.a11y.pause",a,_);return i().createElement("section",{"data-testid":"chapter",className:ke},i().createElement(H.gF,{backgroundColor:g},i().createElement(j.W,null,i().createElement(ee.i,{text:a})),i().createElement("div",{className:ge},i().createElement(x._,{menu:i().createElement(q.r,{uri:r,isPlayed:y,onMarkAsPlayed:b,contextUri:r})},i().createElement(H.Oe,{loading:"eager",name:a,images:k,placeholderType:"episode",shape:H.Kc.ROUNDED_CORNERS}))),i().createElement(H.sP,null,i().createElement(H.dy,{small:!0,uppercase:!0},N.ag.get("web-player.audiobooks.chapter")),i().createElement(x._,{menu:i().createElement(q.r,{uri:r,isPlayed:y,onMarkAsPlayed:b,contextUri:r})},i().createElement(H.xd,{dragUri:r,dragLabel:a},i().createElement("span",{"data-testid":"chapterTitle"},a))),i().createElement(x._,{menu:i().createElement(q.r,{uri:r,isPlayed:y,onMarkAsPlayed:b,contextUri:r})},i().createElement(de.Z,{to:be(B)},i().createElement(H.dy,{large:!0,bold:!0},i().createElement("span",{"data-testid":"bookTitle"},_)))))),i().createElement(f.o,{backgroundColor:g},i().createElement(f.F,null,T.nineteen&&i().createElement(F.X,{className:ve,size:16}),i().createElement(W.E,{size:W.$.LARGE,fullyPlayed:y,durationMs:d.milliseconds,releaseDate:ye(null==c?void 0:c.isoString),resumePositionMs:s.playPositionMilliseconds,isPlaying:P,position:U&&C||void 0})),i().createElement(f.F,null,i().createElement("div",{onClick:I},i().createElement(oe,{episodeUri:r,showUri:B,isLocked:w,onClick:()=>{L(s.playPositionMilliseconds)},isPlaying:P,isPlayDisabled:M,playButtonPlayLabel:X,playButtonPauseLabel:Z})),!w&&i().createElement(pe.o,{uri:r,bookUri:B}),i().createElement(ce.yj,{menu:i().createElement(q.r,{uri:r,isPlayed:y,onMarkAsPlayed:b,contextUri:r})},i().createElement(Q.z,{label:N.ag.get("more.label.context",a)})))),i().createElement("div",{className:"contentSpacing"},i().createElement(u.z,{version:"outlined",linkTo:be(B),className:Ee},"See all chapters")))}));var Se=a(56802),Pe=a(38894),Ne=a(37483),fe=a(51871),Ue=a(25988),Ce=a(70369),xe=a(54280),we=a(38470),Te=a(28248),Fe=a(74600),Ie=a(28120);const Ae=({uri:e,segmentCount:t})=>{const a=(0,xe.G)(),l=(0,n.useCallback)((async(t,n)=>{const i=Math.ceil(t/2);try{return function(e,t,a){return e.reduce(((e,n,i)=>((i>0||t>0)&&e.push({type:"SPACER",id:`spacer-${e.length}`}),"MUSIC"===n.type?e.push(function(e,t,a){return{type:"MUSIC",index:t,uri:a.uri,episodeUri:e,start:a.start,stop:a.stop,duration:a.duration,name:a.track.name,artists:a.track.artists,album:a.track.album,playable:a.track.playable}}(a,i,n)):"TALK"===n.type&&e.push(function(e,t,a){return{type:"TALK",index:t,uri:e,title:a.title,subtitle:a.subtitle,start:a.start,stop:a.stop,duration:a.duration,showUri:a.show.uri,showName:a.show.name}}(a,i,n)),e)),[])}(await a.getSegments(e,i,n),i,e)}catch(e){return[]}}),[a,e]),r=(0,n.useCallback)((t=>{switch(t.type){case"SPACER":return i().createElement("div",{key:t.id,className:Ie.Z.spacerRow});case"MUSIC":return i().createElement(Te.Z,Z()({key:`${e}-${t.index}`},t));case"TALK":return i().createElement(Fe.t,Z()({key:`${e}-${t.index}`},t));default:return(0,we.U)(t)}}),[e]),s=N.ag.get("music_and_talk.in_this_episode");return i().createElement("div",null,i().createElement(d.LF,{as:"h2",variant:"canon",semanticColor:"textBase",className:Ie.Z.header},s),i().createElement(Te.Pv,{ariaLabel:s,hasHeaderRow:!0,rowPlaceholder:Te.hU,columns:[Te.QD.TITLE,Te.QD.ALBUM_OR_SHOW,Te.QD.DURATION],renderRow:r,fetchTracks:l,resolveUri:e=>"MUSIC"===e.type?e.uri:"",limit:50,nrTracks:2*t-1,testID:"music-and-talk-tracklist"}))};var Le=a(98984),De=a(94184),Me=a.n(De),Re=a(4348);const Be="axX_dOb7KXxh2BhADfuQ",_e="DIz7crU76YDtXXLx34nF",ze="R2a58pDnuIWBldpbVPRr",We=i().memo((({title:e,episodes:t,className:a})=>i().createElement("div",{className:Me()(Be,a)},i().createElement(d.LF,{as:"h2",variant:"canon",className:_e},e),i().createElement("div",{className:ze},t.map((e=>i().createElement(Re.B,Z()({key:e.uri},e)))))))),Oe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getRecommendedEpisodes"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recommendedEpisodes"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"releaseDate"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isoString"}}]}},{kind:"Field",name:{kind:"Name",value:"duration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"podcast"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}}]}}]}}]}}]}}]}}]},Ke=({uri:e,limit:t})=>{var a;const{data:n}=(l={uri:e,limit:t},r={cacheTime:15*Le.y},(0,Le.a)(Oe,l,r));var l,r;const s=(null==n||null===(a=n.episode)||void 0===a?void 0:a.recommendedEpisodes.items)||[];return(null==s?void 0:s.length)>0?i().createElement(We,{title:N.ag.get("mwp.entity.might.like"),episodes:s.map(((e,t)=>{var a,n,i,l,r,s,o,d;return{index:t,id:e.episode.id,uri:e.episode.uri,name:e.episode.name,description:null!==(a=e.episode.description)&&void 0!==a?a:"",isExplicit:(null===(n=e.episode.contentRating)||void 0===n?void 0:n.label)===z.KS.Explicit,releaseDate:new Date((null===(i=e.episode.releaseDate)||void 0===i?void 0:i.isoString)||""),is19PlusOnly:(null===(l=e.episode.contentRating)||void 0===l?void 0:l.label)===z.KS.NineteenPlus,durationMilliseconds:e.episode.duration.totalMilliseconds,images:null!==(r=null===(s=e.episode.coverArt)||void 0===s?void 0:s.sources)&&void 0!==r?r:[],showImages:null!==(o=null===(d=e.episode.podcast.coverArt)||void 0===d?void 0:d.sources)&&void 0!==o?o:[],resume_point:null,sharingInfo:null}}))}):null};var Xe=a(68107);function Ze(e){const t=o().from(e);return`/show/${o().hexToId((null==t?void 0:t.id)||"")}`}const $e=({episode:e})=>{var t,a,s,b,h,S,B,_;const{uri:X,name:Z,sharingInfo:$,playedState:V,episodeType:Y,description:J,htmlDescription:q,podcastSubscription:te,contentRating:ae,segmentsCount:ne,playability:ie,coverArt:le,releaseDate:re,podcast:ce,contentInformation:me}=e,ue=(0,r.TH)(),pe=(0,l.I0)(),ke=(0,L.g)(),ve=(0,Se.o)(),ge=(0,c.W6)(m.Cz),[Ee,ye]=(0,n.useState)(V.state===z.sY.Completed),be=(0,c.W6)(m.Be),he=void 0!==ne&&ne>0&&be,xe=(0,Pe.g)(),{triggerPlay:we,togglePlay:Te,isPlaying:Fe,isActive:Ie}=(0,D.n)({uri:X},{featureIdentifier:"episode"}),[Le]=(0,M.z)(1e4,(e=>{var t;return(null==e||null===(t=e.item)||void 0===t?void 0:t.uri)===X})),De=(0,R.Y)((e=>{var t;return null!==(t=null==e?void 0:e.isPaused)&&void 0!==t?t:void 0})),Me=function(e,t,a,n,l){const r=t===z.Wf.Episode;return(0,I.G3)(e,n,a,l)?i().createElement(I.Fg,{isMusicAndTalk:r}):r?N.ag.get("type.showEpisode"):N.ag.get("type.podcastEpisode")}(X,Y||z.Wf.Unknown,V.playPositionMilliseconds,Ye(null==re?void 0:re.isoString),V.state===z.sY.Completed),Re=le[0].url,Be=(0,A.Z)(Re||null),_e=(0,l.v9)((e=>{var t;return null===(t=e.platform)||void 0===t?void 0:t.isBrowser})),ze=te.isPaywalled&&!te.isUserSubscribed,We=(0,Xe.s)(e,ce),{badges:Oe}=(0,O.r)({contentRating:null==ae?void 0:ae.label}),$e=(0,n.useCallback)((e=>{!ie.playable&&Oe.nineteen&&(e.stopPropagation(),pe((0,K.RM)(X||"")))}),[X,ie.playable,Oe.nineteen,pe]),Ve=(0,n.useCallback)(((e,t=!0)=>{if(ze)return;let a="play";!Fe||0!==e&&t||(a="pause"),ve({intent:a,targetUri:X,type:"click",itemIdSuffix:e>0?"podcast-description-timestamp":"button"}),Y===z.Wf.Episode&&_e?T.y.set((()=>({triggerId:se,triggerAction:null}))):Ie&&!t?xe?De?ke.resume():ke.pause():Te():xe?We({seekTo:e}):we({seekTo:e})}),[ze,Fe,ve,X,Y,_e,Ie,xe,De,ke,Te,We,we]),Ge=(0,n.useCallback)((()=>{ve({intent:"expand-description",type:"click"})}),[ve]),Je=J||ge&&q;(0,n.useEffect)((()=>{if(e){const t=new URLSearchParams(ue.search);if(t.has("t")){const a=t.get("t")||"0",n=1e3*parseInt(a,10);n<=e.duration.milliseconds&&Ve(n)}}}),[e]);const Qe=!ze&&!e.playability.playable,qe=N.ag.get("tracklist.a11y.play",e.name,null===(t=e.podcast)||void 0===t?void 0:t.name),He=N.ag.get("tracklist.a11y.pause",e.name,null===(a=e.podcast)||void 0===a?void 0:a.name),je=null===(s=e.podcast)||void 0===s?void 0:s.uri,et=null===(b=o().from(je))||void 0===b?void 0:b.toURLPath(!0);return i().createElement("section",{"data-testid":"episode",className:p},i().createElement(Ce.$,null,N.ag.get("podcasts.episode.seo.title",{name:e.name,show:null!==(h=null===(S=e.podcast)||void 0===S?void 0:S.name)&&void 0!==h?h:""})),i().createElement(H.gF,{backgroundColor:Be},i().createElement(j.W,null,i().createElement(ee.i,{text:e.name,dragUri:X,dragLabel:e.name})),i().createElement("div",{className:y},i().createElement(x._,{menu:i().createElement(Ue.k,{uri:e.uri,sharingInfo:e.sharingInfo,showUri:je,contextUri:e.uri,isPlayed:Ee,onMarkAsPlayed:ye})},i().createElement(H.Oe,{loading:"eager",name:e.name,images:e.coverArt,placeholderType:"episode",shape:H.Kc.ROUNDED_CORNERS}))),i().createElement(H.sP,null,i().createElement(H.dy,{small:!0,uppercase:!0},Me),i().createElement(x._,{menu:i().createElement(Ue.k,{uri:X,sharingInfo:$,showUri:je,contextUri:X,isPlayed:Ee,onMarkAsPlayed:ye})},i().createElement(H.xd,{dragUri:X,dragLabel:Z},i().createElement("span",{"data-testid":"episodeTitle"},Z))),i().createElement(x._,{menu:i().createElement(Ue.k,{uri:e.uri,sharingInfo:e.sharingInfo,showUri:je,contextUri:e.uri,isPlayed:Ee,onMarkAsPlayed:ye})},i().createElement(de.Z,{to:Ze(je)},i().createElement(H.dy,{large:!0,bold:!0},i().createElement("span",{"data-testid":"showTitle"},null===(B=e.podcast)||void 0===B?void 0:B.name)))))),i().createElement(f.o,{backgroundColor:Be},i().createElement(f.F,null,Oe.nineteen&&i().createElement(F.X,{className:E,size:16}),i().createElement(W.E,{size:W.$.LARGE,fullyPlayed:Ee,durationMs:e.duration.milliseconds,releaseDate:Ye(null===(_=e.releaseDate)||void 0===_?void 0:_.isoString),resumePositionMs:V.playPositionMilliseconds,isPlaying:Fe,position:Ie&&Le||void 0})),i().createElement(f.F,null,i().createElement("div",{onClick:$e},i().createElement(oe,{episodeUri:e.uri,showUri:je,isLocked:ze,onClick:()=>{Ve(V.playPositionMilliseconds,!1)},isPlaying:Fe,isPlayDisabled:Qe,playButtonPlayLabel:qe,playButtonPauseLabel:He})),!ze&&i().createElement(Ne.p,{uri:e.uri,showUri:je}),i().createElement(fe.w,{uri:e.uri,size:U.q.md}),i().createElement(C.y,{menu:i().createElement(Ue.k,{uri:e.uri,sharingInfo:e.sharingInfo,showUri:je,contextUri:e.uri,isPlayed:Ee,onMarkAsPlayed:ye})},i().createElement(Q.z,{label:N.ag.get("more.label.context",e.name)})))),i().createElement("div",{className:"contentSpacing"},i().createElement(i().Fragment,null,(Je||me)&&i().createElement(d.LF,{as:"h2",variant:"canon",semanticColor:"textBase",className:v},N.ag.get("episode.description-title")),me&&i().createElement(P,{cardHeaderText:me.cardHeaderText,cardBodyText:me.cardBodyText,buttonText:me.buttonText,buttonTarget:me.buttonTarget}),Je&&i().createElement(w.o,{className:k,onTimeStampClick:Ve,maxLines:4,onExpanded:Ge,content:(e.description||"").trim(),htmlContent:ge&&e.htmlDescription?e.htmlDescription:void 0,LinkComponent:de.Z,enableTimestamps:e.playability.playable})),he&&i().createElement(Ae,{segmentCount:ne,uri:e.uri}),et&&i().createElement(u.z,{version:"outlined",linkTo:et,className:g},N.ag.get("episode.see_all_episodes")),i().createElement(G,{uri:X}),i().createElement(Ke,{uri:X,limit:6})))},Ve=i().memo((()=>{const{episodeId:e}=(0,r.UO)(),t=o().episodeURI(e).toURI(),a=(0,c.W6)(m.uB),l=(0,B.I)(t,a);return l?(0,_.Ey)(l)?i().createElement(n.Suspense,{fallback:null},i().createElement(he,{chapter:l})):i().createElement(n.Suspense,{fallback:null},i().createElement($e,{episode:l})):i().createElement(J.h,{hasError:!1,errorMessage:N.ag.get("error.not_found.title.podcast")})}));function Ye(e){return(null==e?void 0:e.replace(/T.*/,""))||""}}}]);
//# sourceMappingURL=xpui-routes-episode.js.map